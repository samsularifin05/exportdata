function D(s){let g=new Date(s),c=g.getFullYear(),o=String(g.getMonth()+1).padStart(2,"0"),a=String(g.getDate()).padStart(2,"0"),m=String(g.getHours()).padStart(2,"0"),h=String(g.getMinutes()).padStart(2,"0"),l=String(g.getSeconds()).padStart(2,"0");return`${a}-${o}-${c} ${m}:${h}:${l}`}import L from"exceljs";var _=async({columns:s,data:g,grouping:c,date:o,excelSetting:a,title:m,footerSetting:h})=>{let l=new L.Workbook;s=s.filter(n=>!n.options?.disabledColumn);let i=l.addWorksheet(m||a?.titleExcel),$=s.length,E=i.addRow([]);if(E.getCell(1).value=m||a?.titleExcel,E.getCell(1).alignment={horizontal:"center"},i.mergeCells(`A${E.number}:${String.fromCharCode(64+$)}${E.number}`),E.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),o){let n=i.addRow([]);n.getCell(1).value=`${o.caption?o.caption:"Tanggal "} : ${o?.start_date} ${o?.end_date?`s/d ${o?.end_date}`:""}`,n.getCell(1).alignment={horizontal:"center"},i.mergeCells(`A${n.number}:${String.fromCharCode(64+$)}${n.number}`),n.eachCell(t=>{t.font={color:{argb:"00000"},bold:!0,size:12}})}let x=i.addRow([]);x.getCell(1).value=a?.additionalTextHeader||"",x.getCell(1).alignment={horizontal:"center"},i.mergeCells(`A${x.number}:${String.fromCharCode(64+$)}${x.number}`),x.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),i.addRow(s).eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},n.font={color:{argb:a?.txtColor},bold:!0};let t=n.value;n.value&&(n.alignment={horizontal:`${t?.options?.halign?t?.options?.halign:t?.options?.format==="RP"||t?.options?.format==="GR"?"right":"left"}`},n.value=t.label)});let k={};g.forEach(n=>{if(c.length>0){let t=c.map(p=>({value:n[p]!==void 0?`${N(p)} : `+n[p]:""}));i.addRow(t.map(p=>p.value));let y={};n.detail.forEach(p=>{let b=s.map(d=>{let f=d?.options?.format==="DATETIME"?D(p[d.key]):p[d.key],w={horizontal:d?.options?.halign?d?.options?.halign:d?.options?.format==="RP"||d?.options?.format==="GR"?"right":"left"},G=d.key;return k[G]=(k[G]||0)+Number(f),y[G]=(y[G]||0)+Number(f),{value:f,alignment:w,numFmt:d?.options?.format==="RP"?"#,##0":d?.options?.format==="GR"?"#,##0.000":void 0}}),r=i.addRow(b.map(d=>d.value));b.forEach((d,f)=>{let w=r.getCell(f+1);w.alignment=d.alignment,d.numFmt&&(w.numFmt=d.numFmt)})});let e=i.addRow(s.map(()=>null));s.forEach((p,b)=>{if(p?.options?.format==="RP"||p?.options?.format==="GR"){let d=g.length+4-1,f=`SUM(${String.fromCharCode(65+b)}4:${String.fromCharCode(65+b)}${d})`,w=e.getCell(b+1);e.getCell(1).value=`${h?.subTotal?.caption||"SUB TOTAL"} ${h?.subTotal?.enableCount&&`: ${n.detail.length}`} ${h?.subTotal?.captionItem&&h.subTotal.captionItem||""}`,e.getCell(1).alignment={horizontal:"center"},w.numFmt=p?.options?.format==="GR"?"#,##0.000":"#,##0",w.value={formula:f},e.getCell(b+1).value=p?.options.disabledFooter?"":y[p.key]}else e.getCell(b+1).value=""}),a?.grandTotalSetting?.colSpan&&i.mergeCells(`A${e.number}:${String.fromCharCode(64+Number(a?.grandTotalSetting?.colSpan))}${e.number}`),e.eachCell(p=>{p.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},p.font={color:{argb:a?.txtColor},bold:!0}})}else{let t=s.map(e=>{let p=e?.options?.format==="DATETIME"?D(n[e.key]):n[e.key],b={vertical:"middle",horizontal:e?.options?.halign?e?.options?.halign:e?.options?.format==="RP"||e?.options?.format==="GR"?"right":"left"},r=e.key;return k[r]=(k[r]||0)+Number(p),{value:p,options:e?.options,alignment:b,numFmt:e?.options?.format==="RP"?"#,##0":e?.options?.format==="GR"?"#,##0.000":void 0}}),y=i.addRow(t.map(e=>e.value));t.forEach((e,p)=>{let b=y.getCell(p+1),r=e.alignment.vertical?String(e.alignment.vertical||"bottom"):"bottom",d="";(r==="middle"||r==="bottom"||r==="justify"||r==="distributed"||r==="top")&&(d=r),b.alignment={horizontal:e.alignment.horizontal,vertical:d},e.numFmt&&(b.numFmt=e.numFmt)})}});let u=i.addRow(s.map(()=>null));s.forEach((n,t)=>{if(n?.options?.format==="RP"||n?.options?.format==="GR"){let e=g.length+4-1,p=`SUM(${String.fromCharCode(65+t)}4:${String.fromCharCode(65+t)}${e})`,b=u.getCell(t+1);u.getCell(1).value=`
        ${h?.grandTotal?.caption||"GRAND TOTAL"} ${h?.grandTotal?.enableCount&&` : ${c.length>0?g.map(r=>r.detail.length).reduce((r,d)=>r+d,0):g.length} ${h.grandTotal.captionItem&&h.grandTotal.captionItem||""}`}`,u.getCell(1).alignment={horizontal:"center"},b.numFmt=n?.options?.format==="GR"?"#,##0.000":"#,##0",b.value={formula:p},u.getCell(t+1).value=n?.options.disabledFooter?"":k[n.key]}else u.getCell(t+1).value=""}),a?.grandTotalSetting?.colSpan&&i.mergeCells(`A${u.number}:${String.fromCharCode(64+Number(a?.grandTotalSetting?.colSpan))}${u.number}`),u.eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},n.font={color:{argb:a?.txtColor},bold:!0}});let C=await l.xlsx.writeBuffer(),R=new Blob([C],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),T=document.createElement("a");T.href=URL.createObjectURL(R),T.download=`${m||a?.titleExcel}.xlsx`,document.body.appendChild(T),T.click(),document.body.removeChild(T)},F=_,N=s=>s.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");import j from"jspdf";import O from"jspdf-autotable";var U=({columns:s,data:g,grouping:c,pdfSetting:o,date:a,title:m,footerSetting:h})=>{let l=new j(o?.orientation,o?.unit,[o?.width||297,o?.height||210]),i=[],$=a?30:20;s=s.filter(t=>!t.options?.disabledColumn),l.setFontSize(10);let E=l.internal.pageSize.getWidth(),x=l.splitTextToSize(o?.textHeaderLeft||"",110);l.text(x,15,18),l.text(`${m||o?.titlePdf}`,E-15,18,{align:"right"}),a&&l.text(`${a.caption?a.caption:"TANGGAL "} : ${a?.start_date} ${a?.end_date?`s/d ${a?.end_date}`:""}`,E-15,22,{align:"right"}),l.setProperties({title:m||o?.titlePdf});let P=s.map(t=>({content:t.label,key:t.key,options:t?.options,styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:t?.options?.halign?t?.options?.halign:t?.options?.format==="RP"||t?.options?.format==="GR"?"right":"left"}}));i.push(P);let k={};g.forEach(t=>{if(c.length>0){let y=c.map(r=>({content:t[r]!==void 0?`${S(r)} : `+t[r]:""}));i.push(y);let e={};t.detail.forEach(r=>{let d=s.map(f=>{let w=r[f.key],G=f.key;return k[G]=(k[G]||0)+Number(w),e[G]=(e[G]||0)+Number(w),{content:(()=>{switch(f?.options?.format){case"RP":return r[f.key]!==void 0?Number(r[f.key]||0).toLocaleString("kr-ko"):"";case"GR":return r[f.key]!==void 0?Number(r[f.key]||0).toFixed(3):"";case"DATETIME":return r[f.key]!==void 0?D(r[f.key]||new Date):"";default:return r[f.key]!==void 0?r[f.key].toString():""}})(),styles:{halign:f?.options?.halign?f?.options?.halign:f?.options?.format==="RP"||f?.options?.format==="GR"||typeof r[f.key]=="number"?"right":"left"}}});i.push(d)});let p=[];s.forEach(r=>{let d=e[r.key];if(r?.options?.format==="RP"||r?.options?.format==="GR"){let f={content:r?.options?.disabledFooter?"":(()=>{switch(r?.options?.format){case"RP":return d.toLocaleString("kr-ko");case"GR":return d.toFixed(3);default:return d.toString()}})(),styles:{halign:r?.options?.halign?r?.options?.halign:r?.options?.format==="RP"||r?.options?.format==="GR"?"right":"left",textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold"}};p.push(f)}else p.push({content:"",styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold"}})});let b=o?.grandTotalSetting?.colSpan?Number(o?.grandTotalSetting?.colSpan||0)+1:0;p[0]={content:`${h?.subTotal?.caption||"SUB TOTAL"} ${h?.subTotal?.enableCount&&`: ${t.detail.length}`} ${h?.subTotal?.captionItem&&h.subTotal.captionItem||""}`,colSpan:b,styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},o?.grandTotalSetting?.colSpan&&p.splice(1,o?.grandTotalSetting?.colSpan),i.push(p)}else{let y=s.map(e=>{let p=t[e.key],b=e.key;return k[b]=(k[b]||0)+Number(p),{options:e?.options,content:(()=>{switch(e?.options?.format){case"RP":return t[e.key]!==void 0?Number(t[e.key]||0).toLocaleString("kr-ko"):"";case"GR":return t[e.key]!==void 0?Number(t[e.key]||0).toFixed(3):"";case"DATETIME":return t[e.key]!==void 0?D(t[e.key]||new Date):"";default:return t[e.key]!==void 0?t[e.key].toString():""}})(),styles:{halign:e?.options?.halign?e?.options?.halign:e?.options?.format==="RP"||e?.options?.format==="GR"||typeof t[e.key]=="number"?"right":"left"}}});i.push(y)}});let u=[];s.forEach(t=>{let y=k[t.key];if(t?.options?.format==="RP"||t?.options?.format==="GR"){let e={options:t?.options,content:t?.options?.disabledFooter?"":(()=>{switch(t?.options?.format){case"RP":return y.toLocaleString("kr-ko");case"GR":return y.toFixed(3);default:return y.toString()}})(),styles:{halign:t?.options?.halign?t?.options?.halign:t?.options?.format==="RP"||t?.options?.format==="GR"?"right":"left",textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold"}};u.push(e)}else u.push({content:"",options:t?.options,styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold"}})});let C=o?.grandTotalSetting?.colSpan?Number(o?.grandTotalSetting?.colSpan||0)+1:0;o?.grandTotalSetting?.disableGrandTotal||(u[0]={content:`${h?.grandTotal?.caption||"GRAND TOTAL"} ${h?.grandTotal?.enableCount&&` : ${c.length>0?g.map(t=>t.detail.length).reduce((t,y)=>t+y,0):g.length} ${h.grandTotal.captionItem&&h.grandTotal.captionItem||""}`}`,colSpan:C,styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},o?.grandTotalSetting?.colSpan&&u.splice(1,o?.grandTotalSetting?.colSpan),i.push(u)),i.push([{content:`Print Date : ${D(`${new Date}`)}`,colSpan:s.length,styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"italic"}}]),O(l,{head:[],body:i,startY:$,theme:o?.theme||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:o?.fontSIze||8},headStyles:{fontSize:o?.fontSIze||8,textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`},tableLineColor:[255,255,255]}),i=[],$=l.lastAutoTable.finalY;let R=l.internal.getNumberOfPages(),T=l.internal.pageSize.width,n=l.internal.pageSize.height;l.setFontSize(10);for(let t=1;t<R+1;t++){let y=T/2,e=n-10;l.setPage(t),l.text(`${t} of ${R}`,y,e,{align:"center"})}if(o?.openNewTab){let t=l.output("bloburl");window.open(t)}else l.save(`${m||o?.titlePdf}.pdf`)},S=s=>s.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "),z=U;var M=s=>{let g=[];for(let c=0;c<1;c++){let o=s.data.map(a=>{let m=s.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(m);)m=m.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(h,l,i)=>{let $=i.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(a[l])?a[l]:[a[l]]).reduce((P,k)=>P+$.replace(/\{([a-z0-9_]+)\}/gm,u=>{let C=u.replace(/(\{|\})/g,"");if(C.match(/nama_barang/)){let R=C.match(/nama_barang/),T=C==="nama_barang2"?[20,40]:C==="nama_barang3"?[40,60]:[0,20];return k[R]?.slice(...T).trim()||""}if(C.match(/deskripsi_jual/)){let R=C.match(/deskripsi_jual/),T=C==="deskripsi_jual2"?[20,40]:C==="deskripsi_jual3"?[40,60]:[0,20];return k[R]?.slice(...T).trim()||""}if(C.match(/deskripsi/)){let R=C.match(/deskripsi/),T=C==="deskripsi2"?[20,40]:C==="deskripsi3"?[40,60]:[0,20];return k[R]?.slice(...T).trim()||""}return k[C]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return m.replace(/\{([a-z0-9_]+)\}/gm,h=>{let l=h.replace(/(\{|\})/g,"");return l==="intenal_external"?c===0?"Pelanggan":"Internal":l.match(/auto_cut/)?`
VA`:a[l]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail_barang\)/g,"").replace(/[}{]/g,"")});for(let a in o)o[a]+=`

`;g.push(...o)}return g},B=async(s,g)=>{let c=M(s),o=new Blob([c?.join(`
`)||""],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(o),a.download=g,document.body.appendChild(a),a.click(),document.body.removeChild(a)},A=B;var st=({columns:s,data:g,grouping:c,date:o,type:a,txtSetting:m,pdfSetting:h,excelSetting:l,title:i})=>{let $={data:m?.dataTxt?.length?m?.dataTxt:[m?.dataTxt],template:m?.templateTxt};a.forEach(E=>{E==="PDF"?z({pdfSetting:h,date:o,data:g,type:a,columns:s,grouping:c,title:i}):E==="TXT"?A($,m?.titleTxt||""):E==="EXCEL"?F({date:o,data:g,type:a,columns:s,grouping:c,excelSetting:l,title:i}):(F({date:o,data:g,type:a,columns:s,grouping:c,excelSetting:l,title:i}),z({pdfSetting:h,date:o,data:g,type:a,columns:s,grouping:c,title:i}),A($,m?.titleTxt||""))})};export{st as ExportData};
//# sourceMappingURL=index.mjs.map