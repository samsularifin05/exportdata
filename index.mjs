var N=["EXCEL","PDF","TXT","ALL"];function D(r){let g=new Date(r),m=g.getFullYear(),t=String(g.getMonth()+1).padStart(2,"0"),a=String(g.getDate()).padStart(2,"0"),b=String(g.getHours()).padStart(2,"0"),d=String(g.getMinutes()).padStart(2,"0"),i=String(g.getSeconds()).padStart(2,"0");return`${a}-${t}-${m} ${b}:${d}:${i}`}function S(r){return r.every(g=>N.includes(g))}import j from"exceljs";var O=async({columns:r,data:g,grouping:m,date:t,excelSetting:a,title:b,footerSetting:d})=>{let i=new j.Workbook;r=r.filter(n=>!n.options?.disabledColumn);let p=i.addWorksheet(b||a?.titleExcel),w=r.length,G=p.addRow([]);if(G.getCell(1).value=b||a?.titleExcel,G.getCell(1).alignment={horizontal:"center"},p.mergeCells(`A${G.number}:${String.fromCharCode(64+w)}${G.number}`),G.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),t){let n=p.addRow([]);n.getCell(1).value=`${t.caption?t.caption:"Tanggal "} : ${t?.start_date} ${t?.end_date?`s/d ${t?.end_date}`:""}`,n.getCell(1).alignment={horizontal:"center"},p.mergeCells(`A${n.number}:${String.fromCharCode(64+w)}${n.number}`),n.eachCell(e=>{e.font={color:{argb:"00000"},bold:!0,size:12}})}let R=p.addRow([]);R.getCell(1).value=a?.additionalTextHeader||"",R.getCell(1).alignment={horizontal:"center"},p.mergeCells(`A${R.number}:${String.fromCharCode(64+w)}${R.number}`),R.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),p.addRow(r).eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},n.font={color:{argb:a?.txtColor},bold:!0};let e=n.value;n.value&&(n.alignment={horizontal:`${e?.options?.halign?e?.options?.halign:e?.options?.format==="RP"||e?.options?.format==="GR"?"right":"left"}`},n.value=e.label)});let T={};g.forEach(n=>{if(m.length>0){let e=m.map(l=>({value:n[l]!==void 0?`${U(l)} : `+n[l]:""}));p.addRow(e.map(l=>l.value));let y={};n.detail.forEach(l=>{let h=r.map(f=>{let s=f?.options?.format==="DATETIME"?D(l[f.key]):l[f.key],k={horizontal:f?.options?.halign?f?.options?.halign:f?.options?.format==="RP"||f?.options?.format==="GR"?"right":"left"},c=f.key;return T[c]=(T[c]||0)+Number(s),y[c]=(y[c]||0)+Number(s),{value:s,alignment:k,numFmt:f?.options?.format==="RP"?"#,##0":f?.options?.format==="GR"?"#,##0.000":void 0}}),E=p.addRow(h.map(f=>f.value));h.forEach((f,s)=>{let k=E.getCell(s+1);k.alignment=f.alignment,f.numFmt&&(k.numFmt=f.numFmt)})});let o=p.addRow(r.map(()=>null));r.forEach((l,h)=>{if(l?.options?.format==="RP"||l?.options?.format==="GR"){let f=g.length+4-1,s=`SUM(${String.fromCharCode(65+h)}4:${String.fromCharCode(65+h)}${f})`,k=o.getCell(h+1),c=d?.subTotal?.enableCount&&m.length>0?" : "+n.detail.length:"",I=d?.subTotal?.captionItem?d?.subTotal?.captionItem:"";o.getCell(1).value=`${d?.subTotal?.caption||"SUB TOTAL"} ${c} ${I}`,o.getCell(1).alignment={horizontal:"center"},k.numFmt=l?.options?.format==="GR"?"#,##0.000":"#,##0",k.value={formula:s},o.getCell(h+1).value=l?.options.disabledFooter?"":y[l.key]}else o.getCell(h+1).value=""}),a?.grandTotalSetting?.colSpan&&p.mergeCells(`A${o.number}:${String.fromCharCode(64+Number(a?.grandTotalSetting?.colSpan))}${o.number}`),o.eachCell(l=>{l.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},l.font={color:{argb:a?.txtColor},bold:!0}})}else{let e=r.map(o=>{let l=o?.options?.format==="DATETIME"?D(n[o.key]):n[o.key],h={vertical:"middle",horizontal:o?.options?.halign?o?.options?.halign:o?.options?.format==="RP"||o?.options?.format==="GR"?"right":"left"},E=o.key;return T[E]=(T[E]||0)+Number(l),{value:l,options:o?.options,alignment:h,numFmt:o?.options?.format==="RP"?"#,##0":o?.options?.format==="GR"?"#,##0.000":void 0}}),y=p.addRow(e.map(o=>o.value));e.forEach((o,l)=>{let h=y.getCell(l+1),E=o.alignment.vertical?String(o.alignment.vertical||"bottom"):"bottom",f="";(E==="middle"||E==="bottom"||E==="justify"||E==="distributed"||E==="top")&&(f=E),h.alignment={horizontal:o.alignment.horizontal,vertical:f},o.numFmt&&(h.numFmt=o.numFmt)})}});let u=p.addRow(r.map(()=>null));r.forEach((n,e)=>{if(n?.options?.format==="RP"||n?.options?.format==="GR"){let o=g.length+4-1,l=`SUM(${String.fromCharCode(65+e)}4:${String.fromCharCode(65+e)}${o})`,h=u.getCell(e+1),E=d?.grandTotal?.enableCount?m.length>0?" : "+g.map(s=>s.detail.length).reduce((s,k)=>s+k,0):" : "+g.length:"",f=d?.grandTotal?.captionItem?d?.grandTotal?.captionItem:"";u.getCell(1).value=`
      ${d?.grandTotal?.caption||"GRAND TOTAL"} ${E} ${f}`,u.getCell(1).alignment={horizontal:"center"},h.numFmt=n?.options?.format==="GR"?"#,##0.000":"#,##0",h.value={formula:l},u.getCell(e+1).value=n?.options.disabledFooter?"":T[n.key]}else u.getCell(e+1).value=""}),a?.grandTotalSetting?.colSpan&&p.mergeCells(`A${u.number}:${String.fromCharCode(64+Number(a?.grandTotalSetting?.colSpan))}${u.number}`),u.eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},n.font={color:{argb:a?.txtColor},bold:!0}});let C=await i.xlsx.writeBuffer(),x=new Blob([C],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),$=document.createElement("a");$.href=URL.createObjectURL(x),$.download=`${b||a?.titleExcel}.xlsx`,document.body.appendChild($),$.click(),document.body.removeChild($)},A=O,U=r=>r.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ");import H from"jspdf";import X from"jspdf-autotable";var M=({columns:r,data:g,grouping:m,pdfSetting:t,date:a,title:b,footerSetting:d})=>{let i=new H(t?.orientation,t?.unit,[t?.width||297,t?.height||210]),p=[],w=a?30:20;r=r.filter(e=>!e.options?.disabledColumn),i.setFontSize(10);let G=i.internal.pageSize.getWidth(),R=i.splitTextToSize(t?.textHeaderLeft||"",110);i.text(R,15,18),i.text(`${b||t?.titlePdf}`,G-15,18,{align:"right"}),a&&i.text(`${a.caption?a.caption:"TANGGAL "} : ${a?.start_date} ${a?.end_date?`s/d ${a?.end_date}`:""}`,G-15,22,{align:"right"}),i.setProperties({title:b||t?.titlePdf});let F=r.map(e=>({content:e.label,key:e.key,options:e?.options,styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:e?.options?.halign?e?.options?.halign:e?.options?.format==="RP"||e?.options?.format==="GR"?"right":"left"}}));p.push(F);let T={};g.forEach(e=>{if(m.length>0){let y=m.map(s=>({content:e[s]!==void 0?`${B(s)} : `+e[s]:""}));p.push(y);let o={};e.detail.forEach(s=>{let k=r.map(c=>{let I=s[c.key],L=c.key;return T[L]=(T[L]||0)+Number(I),o[L]=(o[L]||0)+Number(I),{content:(()=>{switch(c?.options?.format){case"RP":return s[c.key]!==void 0?Number(s[c.key]||0).toLocaleString("kr-ko"):"";case"GR":return s[c.key]!==void 0?Number(s[c.key]||0).toFixed(3):"";case"DATETIME":return s[c.key]!==void 0?D(s[c.key]||new Date):"";default:return s[c.key]!==void 0?s[c.key].toString():""}})(),styles:{halign:c?.options?.halign?c?.options?.halign:c?.options?.format==="RP"||c?.options?.format==="GR"||typeof s[c.key]=="number"?"right":"left"}}});p.push(k)});let l=[];r.forEach(s=>{let k=o[s.key];if(s?.options?.format==="RP"||s?.options?.format==="GR"){let c={content:s?.options?.disabledFooter?"":(()=>{switch(s?.options?.format){case"RP":return k.toLocaleString("kr-ko");case"GR":return k.toFixed(3);default:return k.toString()}})(),styles:{halign:s?.options?.halign?s?.options?.halign:s?.options?.format==="RP"||s?.options?.format==="GR"?"right":"left",textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold"}};l.push(c)}else l.push({content:"",styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold"}})});let h=t?.grandTotalSetting?.colSpan?Number(t?.grandTotalSetting?.colSpan||0)+1:0,E=d?.subTotal?.enableCount&&m.length>0?" : "+e.detail.length:"",f=d?.subTotal?.captionItem?d?.subTotal?.captionItem:"";l[0]={content:`${d?.subTotal?.caption||"SUB TOTAL"} ${E} ${f}`,colSpan:h,styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},t?.grandTotalSetting?.colSpan&&l.splice(1,t?.grandTotalSetting?.colSpan),p.push(l)}else{let y=r.map(o=>{let l=e[o.key],h=o.key;return T[h]=(T[h]||0)+Number(l),{options:o?.options,content:(()=>{switch(o?.options?.format){case"RP":return e[o.key]!==void 0?Number(e[o.key]||0).toLocaleString("kr-ko"):"";case"GR":return e[o.key]!==void 0?Number(e[o.key]||0).toFixed(3):"";case"DATETIME":return e[o.key]!==void 0?D(e[o.key]||new Date):"";default:return e[o.key]!==void 0?e[o.key].toString():""}})(),styles:{halign:o?.options?.halign?o?.options?.halign:o?.options?.format==="RP"||o?.options?.format==="GR"||typeof e[o.key]=="number"?"right":"left"}}});p.push(y)}});let u=[];r.forEach(e=>{let y=T[e.key];if(e?.options?.format==="RP"||e?.options?.format==="GR"){let o={options:e?.options,content:e?.options?.disabledFooter?"":(()=>{switch(e?.options?.format){case"RP":return y.toLocaleString("kr-ko");case"GR":return y.toFixed(3);default:return y.toString()}})(),styles:{halign:e?.options?.halign?e?.options?.halign:e?.options?.format==="RP"||e?.options?.format==="GR"?"right":"left",textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold"}};u.push(o)}else u.push({content:"",options:e?.options,styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold"}})});let C=t?.grandTotalSetting?.colSpan?Number(t?.grandTotalSetting?.colSpan||0)+1:0;if(!t?.grandTotalSetting?.disableGrandTotal){let e=d?.grandTotal?.enableCount?m.length>0?" : "+g.map(o=>o.detail.length).reduce((o,l)=>o+l,0):" : "+g.length:"",y=d?.grandTotal?.captionItem?d?.grandTotal?.captionItem:"";u[0]={content:`${d?.grandTotal?.caption||"GRAND TOTAL"} ${e} ${y}`,colSpan:C,styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},t?.grandTotalSetting?.colSpan&&u.splice(1,t?.grandTotalSetting?.colSpan),p.push(u)}p.push([{content:`Print Date : ${D(`${new Date}`)}`,colSpan:r.length,styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"italic"}}]),X(i,{head:[],body:p,startY:w,theme:t?.theme||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:t?.fontSIze||8},headStyles:{fontSize:t?.fontSIze||8,textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`},tableLineColor:[255,255,255]}),p=[],w=i.lastAutoTable.finalY;let x=i.internal.getNumberOfPages(),$=i.internal.pageSize.width,n=i.internal.pageSize.height;i.setFontSize(10);for(let e=1;e<x+1;e++){let y=$/2,o=n-10;i.setPage(e),i.text(`${e} of ${x}`,y,o,{align:"center"})}if(t?.openNewTab){let e=i.output("bloburl");window.open(e)}else i.save(`${b||t?.titlePdf}.pdf`)},B=r=>r.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),z=M;var K=r=>{let g=[];for(let m=0;m<1;m++){let t=r.data.map(a=>{let b=r.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(b);)b=b.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(d,i,p)=>{let w=p.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(a[i])?a[i]:[a[i]]).reduce((F,T)=>F+w.replace(/\{([a-z0-9_]+)\}/gm,u=>{let C=u.replace(/(\{|\})/g,"");if(C.match(/nama_barang/)){let x=C.match(/nama_barang/),$=C==="nama_barang2"?[20,40]:C==="nama_barang3"?[40,60]:[0,20];return T[x]?.slice(...$).trim()||""}if(C.match(/deskripsi_jual/)){let x=C.match(/deskripsi_jual/),$=C==="deskripsi_jual2"?[20,40]:C==="deskripsi_jual3"?[40,60]:[0,20];return T[x]?.slice(...$).trim()||""}if(C.match(/deskripsi/)){let x=C.match(/deskripsi/),$=C==="deskripsi2"?[20,40]:C==="deskripsi3"?[40,60]:[0,20];return T[x]?.slice(...$).trim()||""}return T[C]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return b.replace(/\{([a-z0-9_]+)\}/gm,d=>{let i=d.replace(/(\{|\})/g,"");return i==="intenal_external"?m===0?"Pelanggan":"Internal":i.match(/auto_cut/)?`
VA`:a[i]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail_barang\)/g,"").replace(/[}{]/g,"")});for(let a in t)t[a]+=`

`;g.push(...t)}return g},W=async(r,g)=>{let m=K(r),t=new Blob([m?.join(`
`)||""],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download=g,document.body.appendChild(a),a.click(),document.body.removeChild(a)},_=W;var bt=({columns:r,data:g,grouping:m,date:t,type:a,txtSetting:b,pdfSetting:d,excelSetting:i,title:p,footerSetting:w})=>{let G={data:b?.dataTxt?.length?b?.dataTxt:[b?.dataTxt],template:b?.templateTxt};if(g.length===0)throw new Error("Data is required");if(a.length===0)throw new Error("Type is required");if(!S(a))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');a.forEach(R=>{R==="PDF"?z({pdfSetting:d,date:t,data:g,type:a,columns:r,grouping:m,title:p,footerSetting:w}):R==="TXT"?_(G,b?.titleTxt||""):R==="EXCEL"?A({date:t,data:g,type:a,columns:r,grouping:m,excelSetting:i,title:p,footerSetting:w}):(A({date:t,data:g,type:a,columns:r,grouping:m,excelSetting:i,title:p}),z({pdfSetting:d,date:t,data:g,type:a,columns:r,grouping:m,title:p}),_(G,b?.titleTxt||""))})};export{bt as ExportData};
//# sourceMappingURL=index.mjs.map