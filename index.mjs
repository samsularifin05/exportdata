function w(i){let f=new Date(i),b=f.getFullYear(),t=String(f.getMonth()+1).padStart(2,"0"),r=String(f.getDate()).padStart(2,"0"),m=String(f.getHours()).padStart(2,"0"),g=String(f.getMinutes()).padStart(2,"0"),n=String(f.getSeconds()).padStart(2,"0");return`${r}-${t}-${b} ${m}:${g}:${n}`}import L from"exceljs";var z=async({columns:i,data:f,grouping:b,date:t,excelSetting:r,title:m})=>{let g=new L.Workbook;i=i.filter(a=>!a.options?.disabledColumn);let n=g.addWorksheet(m||r?.titleExcel),k=i.length,E=n.addRow([]);if(E.getCell(1).value=m||r?.titleExcel,E.getCell(1).alignment={horizontal:"center"},n.mergeCells(`A${E.number}:${String.fromCharCode(64+k)}${E.number}`),E.eachCell(a=>{a.font={color:{argb:"000000"},bold:!0,size:12}}),t){let a=n.addRow([]);a.getCell(1).value=`Tanggal : ${t?.start_date} ${t?.end_date?`s/d ${t?.end_date}`:""}`,a.getCell(1).alignment={horizontal:"center"},n.mergeCells(`A${a.number}:${String.fromCharCode(64+k)}${a.number}`),a.eachCell(e=>{e.font={color:{argb:"00000"},bold:!0,size:12}})}let R=n.addRow([]);R.getCell(1).value=r?.additionalTextHeader||"",R.getCell(1).alignment={horizontal:"center"},n.mergeCells(`A${R.number}:${String.fromCharCode(64+k)}${R.number}`),R.eachCell(a=>{a.font={color:{argb:"000000"},bold:!0,size:12}}),n.addRow(i).eachCell(a=>{a.fill={type:"pattern",pattern:"solid",fgColor:{argb:r?.bgColor||"#E8E5E5"},bgColor:{argb:r?.bgColor||"#E8E5E5"}},a.font={color:{argb:r?.txtColor},bold:!0};let e=a.value;a.value&&(a.alignment={horizontal:`${e?.options?.halign?e?.options?.halign:e?.options?.format==="RP"||e?.options?.format==="GR"?"right":"left"}`},a.value=e.label)});let u={};f.forEach(a=>{if(b.length>0){let e=b.map(l=>({value:a[l]!==void 0?`${A(l)} : `+a[l]:""}));n.addRow(e.map(l=>l.value));let C={};a.detail.forEach(l=>{let h=i.map(p=>{let d=p?.options?.format==="DATETIME"?w(l[p.key]):l[p.key],G={horizontal:p?.options?.halign?p?.options?.halign:p?.options?.format==="RP"||p?.options?.format==="GR"?"right":"left"},$=p.key;return u[$]=(u[$]||0)+Number(d),C[$]=(C[$]||0)+Number(d),{value:d,alignment:G,numFmt:p?.options?.format==="RP"?"#,##0":p?.options?.format==="GR"?"#,##0.000":void 0}}),s=n.addRow(h.map(p=>p.value));h.forEach((p,d)=>{let G=s.getCell(d+1);G.alignment=p.alignment,p.numFmt&&(G.numFmt=p.numFmt)})});let o=n.addRow(i.map(()=>null));i.forEach((l,h)=>{if(l?.options?.format==="RP"||l?.options?.format==="GR"){let p=f.length+4-1,d=`SUM(${String.fromCharCode(65+h)}4:${String.fromCharCode(65+h)}${p})`,G=o.getCell(h+1);o.getCell(1).value="SUB TOTAL",o.getCell(1).alignment={horizontal:"center"},G.numFmt=l?.options?.format==="GR"?"#,##0.000":"#,##0",G.value={formula:d},o.getCell(h+1).value=l?.options.disabledFooter?"":C[l.key]}else o.getCell(h+1).value=""}),r?.grandTotalSetting?.colSpan&&n.mergeCells(`A${o.number}:${String.fromCharCode(64+Number(r?.grandTotalSetting?.colSpan))}${o.number}`),o.eachCell(l=>{l.fill={type:"pattern",pattern:"solid",fgColor:{argb:r?.bgColor||"#E8E5E5"},bgColor:{argb:r?.bgColor||"#E8E5E5"}},l.font={color:{argb:r?.txtColor},bold:!0}})}else{let e=i.map(o=>{let l=o?.options?.format==="DATETIME"?w(a[o.key]):a[o.key],h={vertical:"middle",horizontal:o?.options?.halign?o?.options?.halign:o?.options?.format==="RP"||o?.options?.format==="GR"?"right":"left"},s=o.key;return u[s]=(u[s]||0)+Number(l),{value:l,options:o?.options,alignment:h,numFmt:o?.options?.format==="RP"?"#,##0":o?.options?.format==="GR"?"#,##0.000":void 0}}),C=n.addRow(e.map(o=>o.value));e.forEach((o,l)=>{let h=C.getCell(l+1),s=o.alignment.vertical?String(o.alignment.vertical||"bottom"):"bottom",p="";(s==="middle"||s==="bottom"||s==="justify"||s==="distributed"||s==="top")&&(p=s),h.alignment={horizontal:o.alignment.horizontal,vertical:p},o.numFmt&&(h.numFmt=o.numFmt)})}});let c=n.addRow(i.map(()=>null));i.forEach((a,e)=>{if(a?.options?.format==="RP"||a?.options?.format==="GR"){let o=f.length+4-1,l=`SUM(${String.fromCharCode(65+e)}4:${String.fromCharCode(65+e)}${o})`,h=c.getCell(e+1);c.getCell(1).value="GRAND TOTAL",c.getCell(1).alignment={horizontal:"center"},h.numFmt=a?.options?.format==="GR"?"#,##0.000":"#,##0",h.value={formula:l},c.getCell(e+1).value=a?.options.disabledFooter?"":u[a.key]}else c.getCell(e+1).value=""}),r?.grandTotalSetting?.colSpan&&n.mergeCells(`A${c.number}:${String.fromCharCode(64+Number(r?.grandTotalSetting?.colSpan))}${c.number}`),c.eachCell(a=>{a.fill={type:"pattern",pattern:"solid",fgColor:{argb:r?.bgColor||"#E8E5E5"},bgColor:{argb:r?.bgColor||"#E8E5E5"}},a.font={color:{argb:r?.txtColor},bold:!0}});let x=await g.xlsx.writeBuffer(),y=new Blob([x],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),T=document.createElement("a");T.href=URL.createObjectURL(y),T.download=`${m||r?.titleExcel}.xlsx`,document.body.appendChild(T),T.click(),document.body.removeChild(T)},F=z,A=i=>i.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ");import _ from"jspdf";import N from"jspdf-autotable";var j=({columns:i,data:f,grouping:b,pdfSetting:t,date:r,title:m})=>{let g=new _(t?.orientation,t?.unit,[t?.width||297,t?.height||210]),n=[],k=r?30:20;i=i.filter(e=>!e.options?.disabledColumn),g.setFontSize(10);let E=g.internal.pageSize.getWidth(),R=g.splitTextToSize(t?.textHeaderLeft||"",110);g.text(R,15,18),g.text(`${m||t?.titlePdf}`,E-15,18,{align:"right"}),r&&g.text(`Tanggal : ${r?.start_date} ${r?.end_date?`s/d ${r?.end_date}`:""}`,E-15,22,{align:"right"}),g.setProperties({title:m||t?.titlePdf});let v=i.map(e=>({content:e.label,key:e.key,options:e?.options,styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:e?.options?.halign?e?.options?.halign:e?.options?.format==="RP"||e?.options?.format==="GR"?"right":"left"}}));n.push(v);let u={};f.forEach(e=>{if(b.length>0){let C=b.map(s=>({content:e[s]!==void 0?`${O(s)} : `+e[s]:""}));n.push(C);let o={};e.detail.forEach(s=>{let p=i.map(d=>{let G=s[d.key],$=d.key;return u[$]=(u[$]||0)+Number(G),o[$]=(o[$]||0)+Number(G),{content:(()=>{switch(d?.options?.format){case"RP":return s[d.key]!==void 0?Number(s[d.key]||0).toLocaleString("kr-ko"):"";case"GR":return s[d.key]!==void 0?Number(s[d.key]||0).toFixed(3):"";case"DATETIME":return s[d.key]!==void 0?w(s[d.key]||new Date):"";default:return s[d.key]!==void 0?s[d.key].toString():""}})(),styles:{halign:d?.options?.halign?d?.options?.halign:d?.options?.format==="RP"||d?.options?.format==="GR"||typeof s[d.key]=="number"?"right":"left"}}});n.push(p)});let l=[];i.forEach(s=>{let p=o[s.key];if(s?.options?.format==="RP"||s?.options?.format==="GR"){let d={content:s?.options?.disabledFooter?"":(()=>{switch(s?.options?.format){case"RP":return p.toLocaleString("kr-ko");case"GR":return p.toFixed(3);default:return p.toString()}})(),styles:{halign:s?.options?.halign?s?.options?.halign:s?.options?.format==="RP"||s?.options?.format==="GR"?"right":"left",textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold"}};l.push(d)}else l.push({content:"",styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold"}})});let h=t?.grandTotalSetting?.colSpan?Number(t?.grandTotalSetting?.colSpan||0)+1:0;l[0]={content:"SUB TOTAL",colSpan:h,styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},t?.grandTotalSetting?.colSpan&&l.splice(1,t?.grandTotalSetting?.colSpan),n.push(l)}else{let C=i.map(o=>{let l=e[o.key],h=o.key;return u[h]=(u[h]||0)+Number(l),{options:o?.options,content:(()=>{switch(o?.options?.format){case"RP":return e[o.key]!==void 0?Number(e[o.key]||0).toLocaleString("kr-ko"):"";case"GR":return e[o.key]!==void 0?Number(e[o.key]||0).toFixed(3):"";case"DATETIME":return e[o.key]!==void 0?w(e[o.key]||new Date):"";default:return e[o.key]!==void 0?e[o.key].toString():""}})(),styles:{halign:o?.options?.halign?o?.options?.halign:o?.options?.format==="RP"||o?.options?.format==="GR"||typeof e[o.key]=="number"?"right":"left"}}});n.push(C)}});let c=[];i.forEach(e=>{let C=u[e.key];if(e?.options?.format==="RP"||e?.options?.format==="GR"){let o={options:e?.options,content:e?.options?.disabledFooter?"":(()=>{switch(e?.options?.format){case"RP":return C.toLocaleString("kr-ko");case"GR":return C.toFixed(3);default:return C.toString()}})(),styles:{halign:e?.options?.halign?e?.options?.halign:e?.options?.format==="RP"||e?.options?.format==="GR"?"right":"left",textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold"}};c.push(o)}else c.push({content:"",options:e?.options,styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold"}})});let x=t?.grandTotalSetting?.colSpan?Number(t?.grandTotalSetting?.colSpan||0)+1:0;t?.grandTotalSetting?.disableGrandTotal||(c[0]={content:"GRAND TOTAL",colSpan:x,styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},t?.grandTotalSetting?.colSpan&&c.splice(1,t?.grandTotalSetting?.colSpan),n.push(c)),n.push([{content:`Print Date : ${w(`${new Date}`)}`,colSpan:i.length,styles:{textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`,fontStyle:"italic"}}]),N(g,{head:[],body:n,startY:k,theme:t?.theme||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:t?.fontSIze||8},headStyles:{fontSize:t?.fontSIze||8,textColor:`#${t?.txtColor||"000"}`,fillColor:`#${t?.bgColor||"E8E5E5"}`},tableLineColor:[255,255,255]}),n=[],k=g.lastAutoTable.finalY;let y=g.internal.getNumberOfPages(),T=g.internal.pageSize.width,a=g.internal.pageSize.height;g.setFontSize(10);for(let e=1;e<y+1;e++){let C=T/2,o=a-10;g.setPage(e),g.text(`${e} of ${y}`,C,o,{align:"center"})}if(t?.openNewTab){let e=g.output("bloburl");window.open(e)}else g.save(`${m||t?.titlePdf}.pdf`)},O=i=>i.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),S=j;var U=i=>{let f=[];for(let b=0;b<1;b++){let t=i.data.map(r=>{let m=i.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(m);)m=m.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(g,n,k)=>{let E=k.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(r[n])?r[n]:[r[n]]).reduce((u,c)=>u+E.replace(/\{([a-z0-9_]+)\}/gm,x=>{let y=x.replace(/(\{|\})/g,"");if(y.match(/nama_barang/)){let T=y.match(/nama_barang/),a=y==="nama_barang2"?[20,40]:y==="nama_barang3"?[40,60]:[0,20];return c[T]?.slice(...a).trim()||""}if(y.match(/deskripsi_jual/)){let T=y.match(/deskripsi_jual/),a=y==="deskripsi_jual2"?[20,40]:y==="deskripsi_jual3"?[40,60]:[0,20];return c[T]?.slice(...a).trim()||""}if(y.match(/deskripsi/)){let T=y.match(/deskripsi/),a=y==="deskripsi2"?[20,40]:y==="deskripsi3"?[40,60]:[0,20];return c[T]?.slice(...a).trim()||""}return c[y]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return m.replace(/\{([a-z0-9_]+)\}/gm,g=>{let n=g.replace(/(\{|\})/g,"");return n==="intenal_external"?b===0?"Pelanggan":"Internal":n.match(/auto_cut/)?`
VA`:r[n]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail_barang\)/g,"").replace(/[}{]/g,"")});for(let r in t)t[r]+=`

`;f.push(...t)}return f},H=async(i,f)=>{let b=U(i),t=new Blob([b?.join(`
`)||""],{type:"text/plain"}),r=document.createElement("a");r.href=URL.createObjectURL(t),r.download=f,document.body.appendChild(r),r.click(),document.body.removeChild(r)},I=H;var st=({columns:i,data:f,grouping:b,date:t,type:r,txtSetting:m,pdfSetting:g,excelSetting:n,title:k})=>{let E={data:m?.dataTxt?.length?m?.dataTxt:[m?.dataTxt],template:m?.templateTxt};r.forEach(R=>{R==="PDF"?S({pdfSetting:g,date:t,data:f,type:r,columns:i,grouping:b,title:k}):R==="TXT"?I(E,m?.titleTxt||""):R==="EXCEL"?F({date:t,data:f,type:r,columns:i,grouping:b,excelSetting:n,title:k}):(F({date:t,data:f,type:r,columns:i,grouping:b,excelSetting:n,title:k}),S({pdfSetting:g,date:t,data:f,type:r,columns:i,grouping:b,title:k}),I(E,m?.titleTxt||""))})};export{st as ExportData};
//# sourceMappingURL=index.mjs.map