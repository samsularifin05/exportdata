function w(s){let d=new Date(s),m=d.getFullYear(),e=String(d.getMonth()+1).padStart(2,"0"),a=String(d.getDate()).padStart(2,"0"),p=String(d.getHours()).padStart(2,"0"),f=String(d.getMinutes()).padStart(2,"0"),b=String(d.getSeconds()).padStart(2,"0");return`${a}-${e}-${m} ${p}:${f}:${b}`}import I from"exceljs";var j=async({columns:s,data:d,grouping:m,date:e,excelSetting:a})=>{let p=new I.Workbook;s=s.filter(t=>!t.options?.disabledColumn);let f=p.addWorksheet(a?.titleExcel),b=s.length,h=f.addRow([]);if(h.getCell(1).value=a?.titleExcel,h.getCell(1).alignment={horizontal:"center"},f.mergeCells(`A${h.number}:${String.fromCharCode(64+b)}${h.number}`),h.eachCell(t=>{t.font={color:{argb:"000000"},bold:!0,size:12}}),e){let t=f.addRow([]);t.getCell(1).value=`Tanggal : ${e?.start_date} ${e?.end_date?`s/d ${e?.end_date}`:""}`,t.getCell(1).alignment={horizontal:"center"},f.mergeCells(`A${t.number}:${String.fromCharCode(64+b)}${t.number}`),t.eachCell(l=>{l.font={color:{argb:"00000"},bold:!0,size:12}})}f.addRow(s).eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},t.font={color:{argb:a?.txtColor},bold:!0};let l=t.value;t.value&&(t.alignment={horizontal:`${l?.options?.halign?l?.options?.halign:l?.options?.format==="RP"||l?.options?.format==="GR"?"right":"left"}`},t.value=l.label)});let y={};d.forEach(t=>{if(m.length>0){let l=m.map(g=>({value:t[g]!==void 0?`${_(g)} : `+t[g]:""}));f.addRow(l.map(g=>g.value));let r={};t.detail.forEach(g=>{let o=s.map(n=>{let u=n?.options?.format==="DATETIME"?w(g[n.key]):g[n.key],c={horizontal:n?.options?.halign?n?.options?.halign:n?.options?.format==="RP"||n?.options?.format==="GR"?"right":"left"},$=n.key;return y[$]=(y[$]||0)+Number(u),r[$]=(r[$]||0)+Number(u),{value:u,alignment:c,numFmt:n?.options?.format==="RP"?"#,##0":n?.options?.format==="GR"?"#,##0.000":void 0}}),C=f.addRow(o.map(n=>n.value));o.forEach((n,u)=>{let c=C.getCell(u+1);c.alignment=n.alignment,n.numFmt&&(c.numFmt=n.numFmt)})});let i=f.addRow(s.map(()=>null));s.forEach((g,o)=>{if(g?.options?.format==="RP"||g?.options?.format==="GR"){let n=d.length+4-1,u=`SUM(${String.fromCharCode(65+o)}4:${String.fromCharCode(65+o)}${n})`,c=i.getCell(o+1);i.getCell(1).value="SUB TOTAL",i.getCell(1).alignment={horizontal:"center"},c.numFmt=g?.options?.format==="GR"?"#,##0.000":"#,##0",c.value={formula:u},i.getCell(o+1).value=g?.options.disabledFooter?"":r[g.key]}else i.getCell(o+1).value=""}),i.eachCell(g=>{g.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},g.font={color:{argb:a?.txtColor},bold:!0}})}else{let l=s.map(i=>{let g=i?.options?.format==="DATETIME"?w(t[i.key]):t[i.key],o={horizontal:i?.options?.halign?i?.options?.halign:i?.options?.format==="RP"||i?.options?.format==="GR"?"right":"left"},C=i.key;return y[C]=(y[C]||0)+Number(g),{value:g,alignment:o,numFmt:i?.options?.format==="RP"?"#,##0":i?.options?.format==="GR"?"#,##0.000":void 0}}),r=f.addRow(l.map(i=>i.value));l.forEach((i,g)=>{let o=r.getCell(g+1);o.alignment=i.alignment,i.numFmt&&(o.numFmt=i.numFmt)})}});let k=f.addRow(s.map(()=>null));s.forEach((t,l)=>{if(t?.options?.format==="RP"||t?.options?.format==="GR"){let i=d.length+4-1,g=`SUM(${String.fromCharCode(65+l)}4:${String.fromCharCode(65+l)}${i})`,o=k.getCell(l+1);k.getCell(1).value="GRAND TOTAL",k.getCell(1).alignment={horizontal:"center"},o.numFmt=t?.options?.format==="GR"?"#,##0.000":"#,##0",o.value={formula:g},k.getCell(l+1).value=t?.options.disabledFooter?"":y[t.key]}else k.getCell(l+1).value=""}),a?.grandTotalSetting?.colSpan&&f.mergeCells(`A${k.number}:${String.fromCharCode(64+Number(a?.grandTotalSetting?.colSpan))}${k.number}`),k.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:a?.bgColor||"#E8E5E5"},bgColor:{argb:a?.bgColor||"#E8E5E5"}},t.font={color:{argb:a?.txtColor},bold:!0}});let G=await p.xlsx.writeBuffer(),T=new Blob([G],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),E=document.createElement("a");E.href=URL.createObjectURL(T),E.download=`${a?.titleExcel}.xlsx`,document.body.appendChild(E),E.click(),document.body.removeChild(E)},P=j,_=s=>s.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");import z from"jspdf";import"jspdf-autotable";var L=({columns:s,data:d,grouping:m,pdfSetting:e,date:a})=>{let p=new z(e?.orientation,e?.unit,[e?.width||297,e?.height||210]),f=[],b=a?30:20;s=s.filter(t=>!t.options?.disabledColumn),p.setFontSize(15),p.text(e?.titlePdf,15,18),p.setFontSize(10),a&&p.text(`Tanggal : ${a?.start_date} ${a?.end_date?`s/d ${a?.end_date}`:""}`,15,25),p.setProperties({title:e?.titlePdf});let h=s.map(t=>({content:t.label,styles:{textColor:`#${e?.txtColor||"000"}`,fillColor:`#${e?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:t?.options?.halign?t?.options?.halign:t?.options?.format==="RP"||t?.options?.format==="GR"?"right":"left"}}));f.push(h);let R={};d.forEach(t=>{if(m.length>0){let l=m.map(o=>({content:t[o]!==void 0?`${S(o)} : `+t[o]:""}));f.push(l);let r={};t.detail.forEach(o=>{let C=s.map(n=>{let u=o[n.key],c=n.key;return R[c]=(R[c]||0)+Number(u),r[c]=(r[c]||0)+Number(u),{content:(()=>{switch(n?.options?.format){case"RP":return o[n.key]!==void 0?Number(o[n.key]||0).toLocaleString("kr-ko"):"";case"GR":return o[n.key]!==void 0?Number(o[n.key]||0).toFixed(3):"";case"DATETIME":return o[n.key]!==void 0?w(o[n.key]||new Date):"";default:return o[n.key]!==void 0?o[n.key].toString():""}})(),styles:{halign:n?.options?.halign?n?.options?.halign:n?.options?.format==="RP"||n?.options?.format==="GR"||typeof o[n.key]=="number"?"right":"left"}}});f.push(C)});let i=[];s.forEach(o=>{let C=r[o.key];if(o?.options?.format==="RP"||o?.options?.format==="GR"){let n={content:o?.options?.disabledFooter?"":(()=>{switch(o?.options?.format){case"RP":return C.toLocaleString("kr-ko");case"GR":return C.toFixed(3);default:return C.toString()}})(),styles:{halign:o?.options?.halign?o?.options?.halign:o?.options?.format==="RP"||o?.options?.format==="GR"?"right":"left",textColor:`#${e?.txtColor||"000"}`,fillColor:`#${e?.bgColor||"E8E5E5"}`,fontStyle:"bold"}};i.push(n)}else i.push({content:"",styles:{textColor:`#${e?.txtColor||"000"}`,fillColor:`#${e?.bgColor||"E8E5E5"}`,fontStyle:"bold"}})});let g=e?.grandTotalSetting?.colSpan?Number(e?.grandTotalSetting?.colSpan||0)+1:0;i[0]={content:"SUB TOTAL",colSpan:g,styles:{textColor:`#${e?.txtColor||"000"}`,fillColor:`#${e?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},e?.grandTotalSetting?.colSpan&&i.splice(1,e?.grandTotalSetting?.colSpan),f.push(i)}else{let l=s.map(r=>{let i=t[r.key],g=r.key;return R[g]=(R[g]||0)+Number(i),{content:(()=>{switch(r?.options?.format){case"RP":return t[r.key]!==void 0?Number(t[r.key]||0).toLocaleString("kr-ko"):"";case"GR":return t[r.key]!==void 0?Number(t[r.key]||0).toFixed(3):"";case"DATETIME":return t[r.key]!==void 0?w(t[r.key]||new Date):"";default:return t[r.key]!==void 0?t[r.key].toString():""}})(),styles:{halign:r?.options?.halign?r?.options?.halign:r?.options?.format==="RP"||r?.options?.format==="GR"||typeof t[r.key]=="number"?"right":"left"}}});f.push(l)}});let y=[];s.forEach(t=>{let l=R[t.key];if(t?.options?.format==="RP"||t?.options?.format==="GR"){let r={content:t?.options?.disabledFooter?"":(()=>{switch(t?.options?.format){case"RP":return l.toLocaleString("kr-ko");case"GR":return l.toFixed(3);default:return l.toString()}})(),styles:{halign:t?.options?.halign?t?.options?.halign:t?.options?.format==="RP"||t?.options?.format==="GR"?"right":"left",textColor:`#${e?.txtColor||"000"}`,fillColor:`#${e?.bgColor||"E8E5E5"}`,fontStyle:"bold"}};y.push(r)}else y.push({content:"",styles:{textColor:`#${e?.txtColor||"000"}`,fillColor:`#${e?.bgColor||"E8E5E5"}`,fontStyle:"bold"}})});let k=e?.grandTotalSetting?.colSpan?Number(e?.grandTotalSetting?.colSpan||0)+1:0;e?.grandTotalSetting?.disableGrandTotal||(y[0]={content:"GRAND TOTAL",colSpan:k,styles:{textColor:`#${e?.txtColor||"000"}`,fillColor:`#${e?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},e?.grandTotalSetting?.colSpan&&y.splice(1,e?.grandTotalSetting?.colSpan),f.push(y)),f.push([{content:`Print Date : ${w(`${new Date}`)}`,colSpan:s.length,styles:{textColor:`#${e?.txtColor||"000"}`,fillColor:`#${e?.bgColor||"E8E5E5"}`,fontStyle:"italic"}}]),p.autoTable({head:[],body:f,startY:b,theme:e?.theme||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:e?.fontSIze||8},headStyles:{fontSize:e?.fontSIze||8,textColor:`#${e?.txtColor||"000"}`,fillColor:`#${e?.bgColor||"E8E5E5"}`}}),b=p.autoTableEndPosY()+3;let G=p.internal.getNumberOfPages(),T=p.internal.pageSize.width,E=p.internal.pageSize.height;p.setFontSize(10);for(let t=1;t<G+1;t++){let l=T/2,r=E-10;p.setPage(t),p.text(`${t} of ${G}`,l,r,{align:"center"})}if(e?.openNewTab){let t=p.output("bloburl");window.open(t)}else p.save(`${e?.titlePdf}.pdf`)},S=s=>s.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),v=L;var A=s=>{let d=[];for(let m=0;m<1;m++){let e=s.data.map(a=>{let p=s.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(p);)p=p.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(f,b,h)=>{let R=h.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(a[b])?a[b]:[a[b]]).reduce((G,T)=>G+R.replace(/\{([a-z0-9_]+)\}/gm,E=>{let t=E.replace(/(\{|\})/g,"");if(t.match(/nama_barang/)){let l=t.match(/nama_barang/),r=t==="nama_barang2"?[20,40]:t==="nama_barang3"?[40,60]:[0,20];return T[l]?.slice(...r).trim()||""}if(t.match(/deskripsi_jual/)){let l=t.match(/deskripsi_jual/),r=t==="deskripsi_jual2"?[20,40]:t==="deskripsi_jual3"?[40,60]:[0,20];return T[l]?.slice(...r).trim()||""}if(t.match(/deskripsi/)){let l=t.match(/deskripsi/),r=t==="deskripsi2"?[20,40]:t==="deskripsi3"?[40,60]:[0,20];return T[l]?.slice(...r).trim()||""}return T[t]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return p.replace(/\{([a-z0-9_]+)\}/gm,f=>{let b=f.replace(/(\{|\})/g,"");return b==="intenal_external"?m===0?"Pelanggan":"Internal":b==="syarat_ketentuan"?m===1?"":`Kondisi / Syarat Perjanjian Jual Beli
-------------------------------------
1.Penjual menyatakan barang tersebut 
adalah miliknya yang sah dan tidak da
lam sengketa dengan pihak manapun.

2. Pembeli memberikan tolenransi sel
ama-lamanya 3 bulan sejak perjanjian 
ini untuk penjual membeli kembali 
barang tersebut

3. Penjual menyatakan apabila setelah 
lewat dari 3 bulan tidak membeli kemb-
ali  barang tersebut, berarti telah 
menjual  secara sah dan memberikan hak 
penuh kepada pembeli atas barang terse-
but, serta membebaskan pembeli dari se-
gala resiko gugatan atas barang tersebut.

4.Penjual dan pembeli mengikatkan diri 
pada perjanjian ini tanpa adanya paksa-
an dari pihak manapun.`:b.match(/auto_cut/)?`
VA`:a[b]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail_barang\)/g,"").replace(/[}{]/g,"")});for(let a in e)e[a]+=`

`;d.push(...e)}return d},N=async(s,d)=>{let m=A(s),e=new Blob([m?.join(`
`)||""],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(e),a.download=d,document.body.appendChild(a),a.click(),document.body.removeChild(a)},F=N;var at=({columns:s,data:d,grouping:m,date:e,type:a,txtSetting:p,pdfSetting:f,excelSetting:b})=>{let h={data:p?.dataTxt?.length?p?.dataTxt:[p?.dataTxt],template:p?.templateTxt};a==="PDF"?v({pdfSetting:f,date:e,data:d,type:a,columns:s,grouping:m}):a==="TXT"?F(h,p?.titleTxt||""):a==="EXCEL"?P({date:e,data:d,type:a,columns:s,grouping:m,excelSetting:b}):(P({date:e,data:d,type:a,columns:s,grouping:m,excelSetting:b}),v({pdfSetting:f,date:e,data:d,type:a,columns:s,grouping:m}),F(h,p?.titleTxt||""))};export{at as ExportData};
//# sourceMappingURL=index.mjs.map