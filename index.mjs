function G(s){let d=new Date(s),h=d.getFullYear(),o=String(d.getMonth()+1).padStart(2,"0"),e=String(d.getDate()).padStart(2,"0"),f=String(d.getHours()).padStart(2,"0"),g=String(d.getMinutes()).padStart(2,"0"),c=String(d.getSeconds()).padStart(2,"0");return`${e}-${o}-${h} ${f}:${g}:${c}`}import I from"exceljs";var _=async({columns:s,data:d,grouping:h,date:o,excelSetting:e})=>{let f=new I.Workbook;s=s.filter(t=>!t.options?.disabledColumn);let g=f.addWorksheet(e?.titleExcel),c=s.length,m=g.addRow([]);if(m.getCell(1).value=e?.titleExcel,m.getCell(1).alignment={horizontal:"center"},g.mergeCells(`A${m.number}:${String.fromCharCode(64+c)}${m.number}`),m.eachCell(t=>{t.font={color:{argb:"000000"},bold:!0,size:12}}),o){let t=g.addRow([]);t.getCell(1).value=`Tanggal : ${o?.start_date} ${o?.end_date?`s/d ${o?.end_date}`:""}`,t.getCell(1).alignment={horizontal:"center"},g.mergeCells(`A${t.number}:${String.fromCharCode(64+c)}${t.number}`),t.eachCell(l=>{l.font={color:{argb:"00000"},bold:!0,size:12}})}g.addRow(s).eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:e?.bgColor||"#E8E5E5"},bgColor:{argb:e?.bgColor||"#E8E5E5"}},t.font={color:{argb:e?.txtColor},bold:!0};let l=t.value;t.value&&(t.alignment={horizontal:`${l?.options?.halign?l?.options?.halign:l?.options?.format==="RP"||l?.options?.format==="GR"?"right":"left"}`},t.value=l.label)});let y={};d.forEach(t=>{if(h.length>0){let l=h.map(p=>({value:t[p]!==void 0?`${z(p)} : `+t[p]:""}));g.addRow(l.map(p=>p.value));let a={};t.detail.forEach(p=>{let r=s.map(n=>{let E=n?.options?.format==="DATETIME"?G(p[n.key]):p[n.key],b={horizontal:n?.options?.halign?n?.options?.halign:n?.options?.format==="RP"||n?.options?.format==="GR"?"right":"left"},$=n.key;return y[$]=(y[$]||0)+Number(E),a[$]=(a[$]||0)+Number(E),{value:E,alignment:b,numFmt:n?.options?.format==="RP"?"#,##0":n?.options?.format==="GR"?"#,##0.000":void 0}}),k=g.addRow(r.map(n=>n.value));r.forEach((n,E)=>{let b=k.getCell(E+1);b.alignment=n.alignment,n.numFmt&&(b.numFmt=n.numFmt)})});let i=g.addRow(s.map(()=>null));s.forEach((p,r)=>{if(p?.options?.format==="RP"||p?.options?.format==="GR"){let n=d.length+4-1,E=`SUM(${String.fromCharCode(65+r)}4:${String.fromCharCode(65+r)}${n})`,b=i.getCell(r+1);i.getCell(1).value="SUB TOTAL",i.getCell(1).alignment={horizontal:"center"},b.numFmt=p?.options?.format==="GR"?"#,##0.000":"#,##0",b.value={formula:E},i.getCell(r+1).value=p?.options.disabledFooter?"":a[p.key]}else i.getCell(r+1).value=""}),i.eachCell(p=>{p.fill={type:"pattern",pattern:"solid",fgColor:{argb:e?.bgColor||"#E8E5E5"},bgColor:{argb:e?.bgColor||"#E8E5E5"}},p.font={color:{argb:e?.txtColor},bold:!0}})}else{let l=s.map(i=>{let p=i?.options?.format==="DATETIME"?G(t[i.key]):t[i.key],r={horizontal:i?.options?.halign?i?.options?.halign:i?.options?.format==="RP"||i?.options?.format==="GR"?"right":"left"},k=i.key;return y[k]=(y[k]||0)+Number(p),{value:p,alignment:r,numFmt:i?.options?.format==="RP"?"#,##0":i?.options?.format==="GR"?"#,##0.000":void 0}}),a=g.addRow(l.map(i=>i.value));l.forEach((i,p)=>{let r=a.getCell(p+1);r.alignment=i.alignment,i.numFmt&&(r.numFmt=i.numFmt)})}});let C=g.addRow(s.map(()=>null));s.forEach((t,l)=>{if(t?.options?.format==="RP"||t?.options?.format==="GR"){let i=d.length+4-1,p=`SUM(${String.fromCharCode(65+l)}4:${String.fromCharCode(65+l)}${i})`,r=C.getCell(l+1);C.getCell(1).value="GRAND TOTAL",C.getCell(1).alignment={horizontal:"center"},r.numFmt=t?.options?.format==="GR"?"#,##0.000":"#,##0",r.value={formula:p},C.getCell(l+1).value=t?.options.disabledFooter?"":y[t.key]}else C.getCell(l+1).value=""}),e?.grandTotalSetting?.colSpan&&g.mergeCells(`A${C.number}:${String.fromCharCode(64+Number(e?.grandTotalSetting?.colSpan))}${C.number}`),C.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:e?.bgColor||"#E8E5E5"},bgColor:{argb:e?.bgColor||"#E8E5E5"}},t.font={color:{argb:e?.txtColor},bold:!0}});let w=await f.xlsx.writeBuffer(),T=new Blob([w],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),u=document.createElement("a");u.href=URL.createObjectURL(T),u.download=`${e?.titleExcel}.xlsx`,document.body.appendChild(u),u.click(),document.body.removeChild(u)},P=_,z=s=>s.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");import L from"jspdf";import"jspdf-autotable";var A=({columns:s,data:d,grouping:h,pdfSetting:o,date:e})=>{let f=new L(o?.orientation,o?.unit,[o?.width||297,o?.height||210]),g=[],c=e?30:20;s=s.filter(t=>!t.options?.disabledColumn),f.setFontSize(15),f.text(o?.titlePdf,15,18),f.setFontSize(10),e&&f.text(`Tanggal : ${e?.start_date} ${e?.end_date?`s/d ${e?.end_date}`:""}`,15,25),f.setProperties({title:o?.titlePdf});let m=s.map(t=>({content:t.label,styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:t?.options?.halign?t?.options?.halign:t?.options?.format==="RP"||t?.options?.format==="GR"?"right":"left"}}));g.push(m);let R={};d.forEach(t=>{if(h.length>0){let l=h.map(r=>({content:t[r]!==void 0?`${N(r)} : `+t[r]:""}));g.push(l);let a={};t.detail.forEach(r=>{let k=s.map(n=>{let E=r[n.key],b=n.key;return R[b]=(R[b]||0)+Number(E),a[b]=(a[b]||0)+Number(E),{content:(()=>{switch(n?.options?.format){case"RP":return r[n.key]!==void 0?Number(r[n.key]||0).toLocaleString("kr-ko"):"";case"GR":return r[n.key]!==void 0?Number(r[n.key]||0).toFixed(3):"";case"DATETIME":return r[n.key]!==void 0?G(r[n.key]||new Date):"";default:return r[n.key]!==void 0?r[n.key].toString():""}})(),styles:{halign:n?.options?.halign?n?.options?.halign:n?.options?.format==="RP"||n?.options?.format==="GR"||typeof r[n.key]=="number"?"right":"left"}}});g.push(k)});let i=[];s.forEach(r=>{let k=a[r.key];if(r?.options?.format==="RP"||r?.options?.format==="GR"){let n={content:r?.options?.disabledFooter?"":(()=>{switch(r?.options?.format){case"RP":return k.toLocaleString("kr-ko");case"GR":return k.toFixed(3);default:return k.toString()}})(),styles:{halign:r?.options?.halign?r?.options?.halign:r?.options?.format==="RP"||r?.options?.format==="GR"?"right":"left",textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold"}};i.push(n)}else i.push({content:"",styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold"}})});let p=o?.grandTotalSetting?.colSpan?Number(o?.grandTotalSetting?.colSpan||0)+1:0;i[0]={content:"SUB TOTAL",colSpan:p,styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},o?.grandTotalSetting?.colSpan&&i.splice(1,o?.grandTotalSetting?.colSpan),g.push(i)}else{let l=s.map(a=>{let i=t[a.key],p=a.key;return R[p]=(R[p]||0)+Number(i),{content:(()=>{switch(a?.options?.format){case"RP":return t[a.key]!==void 0?Number(t[a.key]||0).toLocaleString("kr-ko"):"";case"GR":return t[a.key]!==void 0?Number(t[a.key]||0).toFixed(3):"";case"DATETIME":return t[a.key]!==void 0?G(t[a.key]||new Date):"";default:return t[a.key]!==void 0?t[a.key].toString():""}})(),styles:{halign:a?.options?.halign?a?.options?.halign:a?.options?.format==="RP"||a?.options?.format==="GR"||typeof t[a.key]=="number"?"right":"left"}}});g.push(l)}});let y=[];s.forEach(t=>{let l=R[t.key];if(t?.options?.format==="RP"||t?.options?.format==="GR"){let a={content:t?.options?.disabledFooter?"":(()=>{switch(t?.options?.format){case"RP":return l.toLocaleString("kr-ko");case"GR":return l.toFixed(3);default:return l.toString()}})(),styles:{halign:t?.options?.halign?t?.options?.halign:t?.options?.format==="RP"||t?.options?.format==="GR"?"right":"left",textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold"}};y.push(a)}else y.push({content:"",styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold"}})});let C=o?.grandTotalSetting?.colSpan?Number(o?.grandTotalSetting?.colSpan||0)+1:0;o?.grandTotalSetting?.disableGrandTotal||(y[0]={content:"GRAND TOTAL",colSpan:C,styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},o?.grandTotalSetting?.colSpan&&y.splice(1,o?.grandTotalSetting?.colSpan),g.push(y)),g.push([{content:`Print Date : ${G(`${new Date}`)}`,colSpan:s.length,styles:{textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`,fontStyle:"italic"}}]),f.autoTable({head:[],body:g,startY:c,theme:o?.theme||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:o?.fontSIze||8},headStyles:{fontSize:o?.fontSIze||8,textColor:`#${o?.txtColor||"000"}`,fillColor:`#${o?.bgColor||"E8E5E5"}`}}),c=f.autoTableEndPosY()+3;let w=f.internal.getNumberOfPages(),T=f.internal.pageSize.width,u=f.internal.pageSize.height;f.setFontSize(10);for(let t=1;t<w+1;t++){let l=T/2,a=u-10;f.setPage(t),f.text(`${t} of ${w}`,l,a,{align:"center"})}if(o?.openNewTab){let t=f.output("bloburl");window.open(t)}else f.save(`${o?.titlePdf}.pdf`)},N=s=>s.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "),v=A;var S=s=>{let d=[];for(let h=0;h<1;h++){let o=s.data.map(e=>{let f=s.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(f);)f=f.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(g,c,m)=>{let R=m.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(e[c])?e[c]:[e[c]]).reduce((w,T)=>w+R.replace(/\{([a-z0-9_]+)\}/gm,u=>{let t=u.replace(/(\{|\})/g,"");if(t.match(/nama_barang/)){let l=t.match(/nama_barang/),a=t==="nama_barang2"?[20,40]:t==="nama_barang3"?[40,60]:[0,20];return T[l]?.slice(...a).trim()||""}if(t.match(/deskripsi_jual/)){let l=t.match(/deskripsi_jual/),a=t==="deskripsi_jual2"?[20,40]:t==="deskripsi_jual3"?[40,60]:[0,20];return T[l]?.slice(...a).trim()||""}if(t.match(/deskripsi/)){let l=t.match(/deskripsi/),a=t==="deskripsi2"?[20,40]:t==="deskripsi3"?[40,60]:[0,20];return T[l]?.slice(...a).trim()||""}return T[t]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return f.replace(/\{([a-z0-9_]+)\}/gm,g=>{let c=g.replace(/(\{|\})/g,"");return c==="intenal_external"?h===0?"Pelanggan":"Internal":c.match(/auto_cut/)?`
VA`:e[c]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail_barang\)/g,"").replace(/[}{]/g,"")});for(let e in o)o[e]+=`

`;d.push(...o)}return d},O=async(s,d)=>{let h=S(s),o=new Blob([h?.join(`
`)||""],{type:"text/plain"}),e=document.createElement("a");e.href=URL.createObjectURL(o),e.download=d,document.body.appendChild(e),e.click(),document.body.removeChild(e)},F=O;var et=({columns:s,data:d,grouping:h,date:o,type:e,txtSetting:f,pdfSetting:g,excelSetting:c})=>{let m={data:f?.dataTxt?.length?f?.dataTxt:[f?.dataTxt],template:f?.templateTxt};e==="PDF"?v({pdfSetting:g,date:o,data:d,type:e,columns:s,grouping:h}):e==="TXT"?F(m,f?.titleTxt||""):e==="EXCEL"?P({date:o,data:d,type:e,columns:s,grouping:h,excelSetting:c}):(P({date:o,data:d,type:e,columns:s,grouping:h,excelSetting:c}),v({pdfSetting:g,date:o,data:d,type:e,columns:s,grouping:h}),F(m,f?.titleTxt||""))};export{et as ExportDataFile};
//# sourceMappingURL=index.mjs.map