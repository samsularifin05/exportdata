"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var A=["EXCEL","PDF","TXT","ALL"];function P(i){let d=new Date(i),m=d.getFullYear(),o=String(d.getMonth()+1).padStart(2,"0"),a=String(d.getDate()).padStart(2,"0"),b=String(d.getHours()).padStart(2,"0"),c=String(d.getMinutes()).padStart(2,"0"),f=String(d.getSeconds()).padStart(2,"0");return`${a}-${o}-${m} ${b}:${c}:${f}`}function U(i){return i.every(d=>A.includes(d))}var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var _=async({columns:i,data:d,grouping:m,date:o,excelSetting:a,title:b,footerSetting:c})=>{let f=new _exceljs2.default.Workbook;i=i.filter(t=>!_optionalChain([t, 'access', _2 => _2.options, 'optionalAccess', _3 => _3.disabledColumn]));let n=f.addWorksheet(b||_optionalChain([a, 'optionalAccess', _4 => _4.titleExcel])),$=i.length,E=n.addRow([]);E.getCell(1).value=b||_optionalChain([a, 'optionalAccess', _5 => _5.titleExcel]),E.getCell(1).alignment={horizontal:"center"};let w=n.getColumn($).letter;if(n.mergeCells(`A${E.number}:${w}${E.number}`),E.eachCell(t=>{t.font={color:{argb:"000000"},bold:!0,size:12}}),o){let t=n.addRow([]);t.getCell(1).value=`${o.caption?o.caption:"Tanggal "} : ${_optionalChain([o, 'optionalAccess', _6 => _6.start_date])} ${_optionalChain([o, 'optionalAccess', _7 => _7.end_date])?`s/d ${_optionalChain([o, 'optionalAccess', _8 => _8.end_date])}`:""}`,t.getCell(1).alignment={horizontal:"center"},n.mergeCells(`A${t.number}:${w}${t.number}`),t.eachCell(p=>{p.font={color:{argb:"00000"},bold:!0,size:12}})}let D=n.addRow([]);D.getCell(1).value=_optionalChain([a, 'optionalAccess', _9 => _9.additionalTextHeader])||"",D.getCell(1).alignment={horizontal:"center"},n.mergeCells(`A${D.number}:${w}${D.number}`),D.eachCell(t=>{t.font={color:{argb:"000000"},bold:!0,size:12}}),n.addRow(i).eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _10 => _10.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _11 => _11.bgColor])||"#E8E5E5"}},t.font={color:{argb:_optionalChain([a, 'optionalAccess', _12 => _12.txtColor])},bold:!0};let p=t.value;t.value&&(t.alignment={horizontal:`${_optionalChain([p, 'optionalAccess', _13 => _13.options, 'optionalAccess', _14 => _14.halign])?_optionalChain([p, 'optionalAccess', _15 => _15.options, 'optionalAccess', _16 => _16.halign]):_optionalChain([p, 'optionalAccess', _17 => _17.options, 'optionalAccess', _18 => _18.format])==="RP"||_optionalChain([p, 'optionalAccess', _19 => _19.options, 'optionalAccess', _20 => _20.format])==="GR"||_optionalChain([p, 'optionalAccess', _21 => _21.options, 'optionalAccess', _22 => _22.format])==="NUMBER"?"right":"left"}`},t.value=p.label)});let C={};d.forEach(t=>{if(m.length>0){let p=m.map(g=>({value:t[g]!==void 0?`${j(g)} : `+t[g]:""}));n.addRow(p.map(g=>g.value));let s={};t.detail.forEach(g=>{let h=i.map(e=>{let T=_optionalChain([e, 'optionalAccess', _23 => _23.options, 'optionalAccess', _24 => _24.format])==="DATETIME"?P(g[e.key]):g[e.key],l={horizontal:_optionalChain([e, 'optionalAccess', _25 => _25.options, 'optionalAccess', _26 => _26.halign])?_optionalChain([e, 'optionalAccess', _27 => _27.options, 'optionalAccess', _28 => _28.halign]):_optionalChain([e, 'optionalAccess', _29 => _29.options, 'optionalAccess', _30 => _30.format])==="RP"||_optionalChain([e, 'optionalAccess', _31 => _31.options, 'optionalAccess', _32 => _32.format])==="GR"||_optionalChain([e, 'optionalAccess', _33 => _33.options, 'optionalAccess', _34 => _34.format])==="NUMBER"?"right":"left"},G=e.key;return C[G]=(C[G]||0)+Number(T),s[G]=(s[G]||0)+Number(T),{value:T,alignment:l,numFmt:_optionalChain([e, 'optionalAccess', _35 => _35.options, 'optionalAccess', _36 => _36.format])==="RP"?"#,##0":_optionalChain([e, 'optionalAccess', _37 => _37.options, 'optionalAccess', _38 => _38.format])==="GR"?"#,##0.000":void 0}}),u=n.addRow(h.map(e=>e.value));h.forEach((e,T)=>{let l=u.getCell(T+1);l.alignment=e.alignment,e.numFmt&&(l.numFmt=e.numFmt)})});let r=n.addRow(i.map(()=>null));i.forEach((g,h)=>{if(_optionalChain([g, 'optionalAccess', _39 => _39.options, 'optionalAccess', _40 => _40.format])==="RP"||_optionalChain([g, 'optionalAccess', _41 => _41.options, 'optionalAccess', _42 => _42.format])==="GR"||_optionalChain([g, 'optionalAccess', _43 => _43.options, 'optionalAccess', _44 => _44.format])==="NUMBER"){let e=d.length+4-1,T=`SUM(${String.fromCharCode(65+h)}4:${String.fromCharCode(65+h)}${e})`,l=r.getCell(h+1),G=_optionalChain([c, 'optionalAccess', _45 => _45.subTotal, 'optionalAccess', _46 => _46.enableCount])&&m.length>0?" : "+t.detail.length:"",v=_optionalChain([c, 'optionalAccess', _47 => _47.subTotal, 'optionalAccess', _48 => _48.captionItem])?_optionalChain([c, 'optionalAccess', _49 => _49.subTotal, 'optionalAccess', _50 => _50.captionItem]):"";r.getCell(1).value=`${_optionalChain([c, 'optionalAccess', _51 => _51.subTotal, 'optionalAccess', _52 => _52.caption])||"SUB TOTAL"} ${G} ${v}`,r.getCell(1).alignment={horizontal:"center"},l.numFmt=_optionalChain([g, 'optionalAccess', _53 => _53.options, 'optionalAccess', _54 => _54.format])==="GR"?"#,##0.000":"#,##0",l.value={formula:T},r.getCell(h+1).value=_optionalChain([g, 'optionalAccess', _55 => _55.options, 'access', _56 => _56.disabledFooter])?"":s[g.key]}else r.getCell(h+1).value=""}),_optionalChain([a, 'optionalAccess', _57 => _57.grandTotalSetting, 'optionalAccess', _58 => _58.colSpan])&&n.mergeCells(`A${r.number}:${String.fromCharCode(64+Number(_optionalChain([a, 'optionalAccess', _59 => _59.grandTotalSetting, 'optionalAccess', _60 => _60.colSpan])))}${r.number}`),r.eachCell(g=>{g.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _61 => _61.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _62 => _62.bgColor])||"#E8E5E5"}},g.font={color:{argb:_optionalChain([a, 'optionalAccess', _63 => _63.txtColor])},bold:!0}})}else{let p=i.map(r=>{let g=_optionalChain([r, 'optionalAccess', _64 => _64.options, 'optionalAccess', _65 => _65.format])==="DATETIME"?P(t[r.key]):t[r.key],h={vertical:"middle",horizontal:_optionalChain([r, 'optionalAccess', _66 => _66.options, 'optionalAccess', _67 => _67.halign])?_optionalChain([r, 'optionalAccess', _68 => _68.options, 'optionalAccess', _69 => _69.halign]):_optionalChain([r, 'optionalAccess', _70 => _70.options, 'optionalAccess', _71 => _71.format])==="RP"||_optionalChain([r, 'optionalAccess', _72 => _72.options, 'optionalAccess', _73 => _73.format])==="GR"||_optionalChain([r, 'optionalAccess', _74 => _74.options, 'optionalAccess', _75 => _75.format])==="NUMBER"?"right":"left"},u=r.key;return C[u]=(C[u]||0)+Number(g),{value:g,options:_optionalChain([r, 'optionalAccess', _76 => _76.options]),alignment:h,numFmt:_optionalChain([r, 'optionalAccess', _77 => _77.options, 'optionalAccess', _78 => _78.format])==="RP"?"#,##0":_optionalChain([r, 'optionalAccess', _79 => _79.options, 'optionalAccess', _80 => _80.format])==="GR"?"#,##0.000":void 0}}),s=n.addRow(p.map(r=>r.value));p.forEach((r,g)=>{let h=s.getCell(g+1),u=r.alignment.vertical?String(r.alignment.vertical||"bottom"):"bottom",e="";(u==="middle"||u==="bottom"||u==="justify"||u==="distributed"||u==="top")&&(e=u),h.alignment={horizontal:r.alignment.horizontal,vertical:e},r.numFmt&&(h.numFmt=r.numFmt)})}});let R=n.addRow(i.map(()=>null));i.forEach((t,p)=>{if(_optionalChain([t, 'optionalAccess', _81 => _81.options, 'optionalAccess', _82 => _82.format])==="RP"||_optionalChain([t, 'optionalAccess', _83 => _83.options, 'optionalAccess', _84 => _84.format])==="GR"||_optionalChain([t, 'optionalAccess', _85 => _85.options, 'optionalAccess', _86 => _86.format])==="NUMBER"){let r=d.length+4-1,g=`SUM(${String.fromCharCode(65+p)}4:${String.fromCharCode(65+p)}${r})`,h=R.getCell(p+1),u=_optionalChain([c, 'optionalAccess', _87 => _87.grandTotal, 'optionalAccess', _88 => _88.enableCount])?m.length>0?" : "+d.map(l=>l.detail.length).reduce((l,G)=>l+G,0):" : "+d.length:"",e=_optionalChain([c, 'optionalAccess', _89 => _89.grandTotal, 'optionalAccess', _90 => _90.captionItem])?_optionalChain([c, 'optionalAccess', _91 => _91.grandTotal, 'optionalAccess', _92 => _92.captionItem]):"",T=`${_optionalChain([c, 'optionalAccess', _93 => _93.grandTotal, 'optionalAccess', _94 => _94.caption])||"GRAND TOTAL"} ${u} ${e}`;R.getCell(1).value=T,R.getCell(1).alignment={horizontal:"center"},h.numFmt=_optionalChain([t, 'optionalAccess', _95 => _95.options, 'optionalAccess', _96 => _96.format])==="GR"?"#,##0.000":"#,##0",h.value={formula:g},R.getCell(p+1).value=_optionalChain([t, 'optionalAccess', _97 => _97.options, 'access', _98 => _98.disabledFooter])?"":C[t.key]}else R.getCell(p+1).value=""}),_optionalChain([a, 'optionalAccess', _99 => _99.grandTotalSetting, 'optionalAccess', _100 => _100.colSpan])&&n.mergeCells(`A${R.number}:${String.fromCharCode(64+Number(_optionalChain([a, 'optionalAccess', _101 => _101.grandTotalSetting, 'optionalAccess', _102 => _102.colSpan])))}${R.number}`),R.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _103 => _103.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _104 => _104.bgColor])||"#E8E5E5"}},t.font={color:{argb:_optionalChain([a, 'optionalAccess', _105 => _105.txtColor])},bold:!0}}),_optionalChain([a, 'optionalAccess', _106 => _106.customize])&&a.customize(n);let y=await f.xlsx.writeBuffer(),x=new Blob([y],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),k=document.createElement("a");k.href=URL.createObjectURL(x),k.download=`${_optionalChain([a, 'optionalAccess', _107 => _107.titleExcel])||b}.xlsx`,document.body.appendChild(k),k.click(),document.body.removeChild(k)},N=_,j=i=>i.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var S=({columns:i,data:d,grouping:m,pdfSetting:o,date:a,title:b,footerSetting:c})=>{let f=new (0, _jspdf2.default)(_optionalChain([o, 'optionalAccess', _108 => _108.orientation]),_optionalChain([o, 'optionalAccess', _109 => _109.unit]),[_optionalChain([o, 'optionalAccess', _110 => _110.width])||297,_optionalChain([o, 'optionalAccess', _111 => _111.height])||210]),n=[],$=a?30:20;i=i.filter(t=>!_optionalChain([t, 'access', _112 => _112.options, 'optionalAccess', _113 => _113.disabledColumn])),f.setFontSize(10);let E=f.internal.pageSize.getWidth(),w=f.splitTextToSize(_optionalChain([o, 'optionalAccess', _114 => _114.textHeaderLeft])||"",110);f.text(w,15,18),f.text(`${b||_optionalChain([o, 'optionalAccess', _115 => _115.titlePdf])}`,E-15,18,{align:"right"}),a&&f.text(`${a.caption?a.caption:"TANGGAL "} : ${_optionalChain([a, 'optionalAccess', _116 => _116.start_date])} ${_optionalChain([a, 'optionalAccess', _117 => _117.end_date])?`s/d ${_optionalChain([a, 'optionalAccess', _118 => _118.end_date])}`:""}`,E-15,22,{align:"right"}),f.setProperties({title:b||_optionalChain([o, 'optionalAccess', _119 => _119.titlePdf])}),_optionalChain([o, 'optionalAccess', _120 => _120.finalY])&&(console.log(o.finalY),$=o.finalY);let D=i.map(t=>({content:t.label,key:t.key,options:_optionalChain([t, 'optionalAccess', _121 => _121.options]),styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _122 => _122.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _123 => _123.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:_optionalChain([t, 'optionalAccess', _124 => _124.options, 'optionalAccess', _125 => _125.halign])?_optionalChain([t, 'optionalAccess', _126 => _126.options, 'optionalAccess', _127 => _127.halign]):_optionalChain([t, 'optionalAccess', _128 => _128.options, 'optionalAccess', _129 => _129.format])==="RP"||_optionalChain([t, 'optionalAccess', _130 => _130.options, 'optionalAccess', _131 => _131.format])==="GR"||_optionalChain([t, 'optionalAccess', _132 => _132.options, 'optionalAccess', _133 => _133.format])==="NUMBER"?"right":"left"}}));n.push(D);let F={};d.forEach(t=>{if(m.length>0){let p=m.map(e=>({content:t[e]!==void 0?`${H(e)} : `+t[e]:""}));n.push(p);let s={};t.detail.forEach(e=>{let T=i.map(l=>{let G=e[l.key],v=l.key;return F[v]=(F[v]||0)+Number(G),s[v]=(s[v]||0)+Number(G),{content:(()=>{switch(_optionalChain([l, 'optionalAccess', _134 => _134.options, 'optionalAccess', _135 => _135.format])){case"RP":return e[l.key]!==void 0?Number(e[l.key]||0).toLocaleString("kr-ko"):"";case"GR":return e[l.key]!==void 0?Number(e[l.key]||0).toFixed(3):"";case"NUMBER":return e[l.key]!==void 0?Number(e[l.key]||0):"";case"DATETIME":return e[l.key]!==void 0?P(e[l.key]||new Date):"";default:return e[l.key]!==void 0?e[l.key].toString():""}})(),styles:{halign:_optionalChain([l, 'optionalAccess', _136 => _136.options, 'optionalAccess', _137 => _137.halign])?_optionalChain([l, 'optionalAccess', _138 => _138.options, 'optionalAccess', _139 => _139.halign]):_optionalChain([l, 'optionalAccess', _140 => _140.options, 'optionalAccess', _141 => _141.format])==="RP"||_optionalChain([l, 'optionalAccess', _142 => _142.options, 'optionalAccess', _143 => _143.format])==="GR"||_optionalChain([l, 'optionalAccess', _144 => _144.options, 'optionalAccess', _145 => _145.format])==="NUMBER"||typeof e[l.key]=="number"?"right":"left"}}});n.push(T)});let r=[];i.forEach(e=>{let T=s[e.key];if(_optionalChain([e, 'optionalAccess', _146 => _146.options, 'optionalAccess', _147 => _147.format])==="RP"||_optionalChain([e, 'optionalAccess', _148 => _148.options, 'optionalAccess', _149 => _149.format])==="GR"||_optionalChain([e, 'optionalAccess', _150 => _150.options, 'optionalAccess', _151 => _151.format])==="NUMBER"){let l={content:_optionalChain([e, 'optionalAccess', _152 => _152.options, 'optionalAccess', _153 => _153.disabledFooter])?"":(()=>{switch(_optionalChain([e, 'optionalAccess', _154 => _154.options, 'optionalAccess', _155 => _155.format])){case"RP":return T.toLocaleString("kr-ko");case"GR":return T.toFixed(3);case"NUMBER":return T;default:return T.toString()}})(),styles:{halign:_optionalChain([e, 'optionalAccess', _156 => _156.options, 'optionalAccess', _157 => _157.halign])?_optionalChain([e, 'optionalAccess', _158 => _158.options, 'optionalAccess', _159 => _159.halign]):_optionalChain([e, 'optionalAccess', _160 => _160.options, 'optionalAccess', _161 => _161.format])==="RP"||_optionalChain([e, 'optionalAccess', _162 => _162.options, 'optionalAccess', _163 => _163.format])==="GR"||_optionalChain([e, 'optionalAccess', _164 => _164.options, 'optionalAccess', _165 => _165.format])==="NUMBER"?"right":"left",textColor:`#${_optionalChain([o, 'optionalAccess', _166 => _166.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _167 => _167.bgColor])||"E8E5E5"}`,fontStyle:"bold"}};r.push(l)}else r.push({content:"",styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _168 => _168.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _169 => _169.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let g=_optionalChain([o, 'optionalAccess', _170 => _170.grandTotalSetting, 'optionalAccess', _171 => _171.colSpan])?Number(_optionalChain([o, 'optionalAccess', _172 => _172.grandTotalSetting, 'optionalAccess', _173 => _173.colSpan])||0)+1:0,h=_optionalChain([c, 'optionalAccess', _174 => _174.subTotal, 'optionalAccess', _175 => _175.enableCount])&&m.length>0?" : "+t.detail.length:"",u=_optionalChain([c, 'optionalAccess', _176 => _176.subTotal, 'optionalAccess', _177 => _177.captionItem])?_optionalChain([c, 'optionalAccess', _178 => _178.subTotal, 'optionalAccess', _179 => _179.captionItem]):"";r[0]={content:`${_optionalChain([c, 'optionalAccess', _180 => _180.subTotal, 'optionalAccess', _181 => _181.caption])||"SUB TOTAL"} ${h} ${u}`,colSpan:g,styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _182 => _182.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _183 => _183.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([o, 'optionalAccess', _184 => _184.grandTotalSetting, 'optionalAccess', _185 => _185.colSpan])&&r.splice(1,_optionalChain([o, 'optionalAccess', _186 => _186.grandTotalSetting, 'optionalAccess', _187 => _187.colSpan])),n.push(r)}else{let p=i.map(s=>{let r=t[s.key],g=s.key;return F[g]=(F[g]||0)+Number(r),{options:_optionalChain([s, 'optionalAccess', _188 => _188.options]),content:(()=>{switch(_optionalChain([s, 'optionalAccess', _189 => _189.options, 'optionalAccess', _190 => _190.format])){case"RP":return t[s.key]!==void 0?Number(t[s.key]||0).toLocaleString("kr-ko"):"";case"GR":return t[s.key]!==void 0?Number(t[s.key]||0).toFixed(3):"";case"NUMBER":return t[s.key]!==void 0?Number(t[s.key]||0):"";case"DATETIME":return t[s.key]!==void 0?P(t[s.key]||new Date):"";default:return t[s.key]!==void 0?_optionalChain([t, 'access', _191 => _191[s.key], 'optionalAccess', _192 => _192.toString, 'call', _193 => _193()]):""}})(),styles:{halign:_optionalChain([s, 'optionalAccess', _194 => _194.options, 'optionalAccess', _195 => _195.halign])?_optionalChain([s, 'optionalAccess', _196 => _196.options, 'optionalAccess', _197 => _197.halign]):_optionalChain([s, 'optionalAccess', _198 => _198.options, 'optionalAccess', _199 => _199.format])==="RP"||_optionalChain([s, 'optionalAccess', _200 => _200.options, 'optionalAccess', _201 => _201.format])==="GR"||_optionalChain([s, 'optionalAccess', _202 => _202.options, 'optionalAccess', _203 => _203.format])==="NUMBER"||typeof t[s.key]=="number"?"right":"left"}}});n.push(p)}});let C=[];i.forEach(t=>{let p=F[t.key];if(_optionalChain([t, 'optionalAccess', _204 => _204.options, 'optionalAccess', _205 => _205.format])==="RP"||_optionalChain([t, 'optionalAccess', _206 => _206.options, 'optionalAccess', _207 => _207.format])==="GR"||_optionalChain([t, 'optionalAccess', _208 => _208.options, 'optionalAccess', _209 => _209.format])==="NUMBER"){let s={options:_optionalChain([t, 'optionalAccess', _210 => _210.options]),content:_optionalChain([t, 'optionalAccess', _211 => _211.options, 'optionalAccess', _212 => _212.disabledFooter])?"":(()=>{switch(_optionalChain([t, 'optionalAccess', _213 => _213.options, 'optionalAccess', _214 => _214.format])){case"RP":return p.toLocaleString("kr-ko");case"GR":return p.toFixed(3);case"NUMBER":return p;default:return p.toString()}})(),styles:{halign:_optionalChain([t, 'optionalAccess', _215 => _215.options, 'optionalAccess', _216 => _216.halign])?_optionalChain([t, 'optionalAccess', _217 => _217.options, 'optionalAccess', _218 => _218.halign]):_optionalChain([t, 'optionalAccess', _219 => _219.options, 'optionalAccess', _220 => _220.format])==="RP"||_optionalChain([t, 'optionalAccess', _221 => _221.options, 'optionalAccess', _222 => _222.format])==="GR"||_optionalChain([t, 'optionalAccess', _223 => _223.options, 'optionalAccess', _224 => _224.format])==="NUMBER"?"right":"left",textColor:`#${_optionalChain([o, 'optionalAccess', _225 => _225.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _226 => _226.bgColor])||"E8E5E5"}`,fontStyle:"bold"}};C.push(s)}else C.push({content:"",options:_optionalChain([t, 'optionalAccess', _227 => _227.options]),styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _228 => _228.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _229 => _229.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let R=_optionalChain([o, 'optionalAccess', _230 => _230.grandTotalSetting, 'optionalAccess', _231 => _231.colSpan])?Number(_optionalChain([o, 'optionalAccess', _232 => _232.grandTotalSetting, 'optionalAccess', _233 => _233.colSpan])||0)+1:0;if(!_optionalChain([o, 'optionalAccess', _234 => _234.grandTotalSetting, 'optionalAccess', _235 => _235.disableGrandTotal])){let t=_optionalChain([c, 'optionalAccess', _236 => _236.grandTotal, 'optionalAccess', _237 => _237.enableCount])?m.length>0?" : "+d.map(s=>s.detail.length).reduce((s,r)=>s+r,0):" : "+d.length:"",p=_optionalChain([c, 'optionalAccess', _238 => _238.grandTotal, 'optionalAccess', _239 => _239.captionItem])?_optionalChain([c, 'optionalAccess', _240 => _240.grandTotal, 'optionalAccess', _241 => _241.captionItem]):"";C[0]={content:`${_optionalChain([c, 'optionalAccess', _242 => _242.grandTotal, 'optionalAccess', _243 => _243.caption])||"GRAND TOTAL"} ${t} ${p}`,colSpan:R,styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _244 => _244.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _245 => _245.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([o, 'optionalAccess', _246 => _246.grandTotalSetting, 'optionalAccess', _247 => _247.colSpan])&&C.splice(1,_optionalChain([o, 'optionalAccess', _248 => _248.grandTotalSetting, 'optionalAccess', _249 => _249.colSpan])),n.push(C)}n.push([{content:`Print Date : ${P(`${new Date}`)}`,colSpan:i.length,styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _250 => _250.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _251 => _251.bgColor])||"E8E5E5"}`,fontStyle:"italic"}}]),_jspdfautotable2.default.call(void 0, f,{head:[],body:n,startY:$,theme:_optionalChain([o, 'optionalAccess', _252 => _252.theme])||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:_optionalChain([o, 'optionalAccess', _253 => _253.fontSIze])||8},headStyles:{fontSize:_optionalChain([o, 'optionalAccess', _254 => _254.fontSIze])||8,textColor:`#${_optionalChain([o, 'optionalAccess', _255 => _255.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _256 => _256.bgColor])||"E8E5E5"}`},tableLineColor:[255,255,255]}),n=[],$=f.lastAutoTable.finalY;let y=f.internal.getNumberOfPages(),x=f.internal.pageSize.width,k=f.internal.pageSize.height;f.setFontSize(10);for(let t=1;t<y+1;t++){let p=x/2,s=k-10;f.setPage(t),f.text(`${t} of ${y}`,p,s,{align:"center"})}if(typeof _optionalChain([o, 'optionalAccess', _257 => _257.customize])=="function"&&o.customize(f,$,_jspdfautotable2.default),_optionalChain([o, 'optionalAccess', _258 => _258.openNewTab])){let t=f.output("bloburl");window.open(t)}else f.save(`${_optionalChain([o, 'optionalAccess', _259 => _259.titlePdf])||b}.pdf`)},H=i=>i.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "),L=S;var X=i=>{let d=[],m=i.copy?2:1;for(let o=0;o<m;o++){let a=i.data.map(b=>{let c=i.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(c);)c=c.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(f,n,$)=>{let E=$.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(b[n])?b[n]:[b[n]]).reduce((F,C)=>F+E.replace(/\{([a-z0-9_]+)\}/gm,R=>{let y=R.replace(/(\{|\})/g,"");if(y.match(/nama_barang/)){let x=y.match(/nama_barang/),k=y==="nama_barang2"?[20,40]:y==="nama_barang3"?[40,60]:[0,20];return _optionalChain([C, 'access', _260 => _260[x], 'optionalAccess', _261 => _261.slice, 'call', _262 => _262(...k), 'access', _263 => _263.trim, 'call', _264 => _264()])||""}if(y.match(/deskripsi_jual/)){let x=y.match(/deskripsi_jual/),k=y==="deskripsi_jual2"?[20,40]:y==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([C, 'access', _265 => _265[x], 'optionalAccess', _266 => _266.slice, 'call', _267 => _267(...k), 'access', _268 => _268.trim, 'call', _269 => _269()])||""}if(y.match(/deskripsi/)){let x=y.match(/deskripsi/),k=y==="deskripsi2"?[20,40]:y==="deskripsi3"?[40,60]:[0,20];return _optionalChain([C, 'access', _270 => _270[x], 'optionalAccess', _271 => _271.slice, 'call', _272 => _272(...k), 'access', _273 => _273.trim, 'call', _274 => _274()])||""}return C[y]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return c.replace(/\{([a-z0-9_]+)\}/gm,f=>{let n=f.replace(/(\{|\})/g,"");return n.match(/auto_cut/)?`
VA`:b[n]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail\)/g,"").replace(/[}{]/g,"")});for(let b in a)a[b]+=`

`;d.push(...a)}return d},Y=async(i,d)=>{let m=X(i),o=new Blob([_optionalChain([m, 'optionalAccess', _275 => _275.join, 'call', _276 => _276(`
`)])||""],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(o),a.download=d,document.body.appendChild(a),a.click(),document.body.removeChild(a)},z=Y;var mt=({columns:i,data:d,grouping:m,date:o,type:a,txtSetting:b,pdfSetting:c,excelSetting:f,title:n,footerSetting:$})=>{let E={data:[_optionalChain([b, 'optionalAccess', _277 => _277.dataTxt])],template:_optionalChain([b, 'optionalAccess', _278 => _278.templateTxt]),copy:_optionalChain([b, 'optionalAccess', _279 => _279.copy])};if(d.length===0)throw new Error("Data is required");if(a.length===0)throw new Error("Type is required");if(!U(a))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');a.forEach(w=>{w==="PDF"?L({pdfSetting:c,date:o,data:d,type:a,columns:i,grouping:m,title:n,footerSetting:$}):w==="TXT"?z(E,_optionalChain([b, 'optionalAccess', _280 => _280.titleTxt])||""):w==="EXCEL"?N({date:o,data:d,type:a,columns:i,grouping:m,excelSetting:f,title:n,footerSetting:$}):(N({date:o,data:d,type:a,columns:i,grouping:m,excelSetting:f,title:n}),L({pdfSetting:c,date:o,data:d,type:a,columns:i,grouping:m,title:n}),z(E,_optionalChain([b, 'optionalAccess', _281 => _281.titleTxt])||""))})};exports.ExportData = mt;
//# sourceMappingURL=index.js.map