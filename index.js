"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var _browser = require('bwip-js/browser'); var _browser2 = _interopRequireDefault(_browser);function G(i){let m=new Date(i),c=m.getFullYear(),t=String(m.getMonth()+1).padStart(2,"0"),r=String(m.getDate()).padStart(2,"0"),h=String(m.getHours()).padStart(2,"0"),p=String(m.getMinutes()).padStart(2,"0"),n=String(m.getSeconds()).padStart(2,"0");return`${r}-${t}-${c} ${h}:${p}:${n}`}var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var A=async({columns:i,data:m,grouping:c,date:t,excelSetting:r,title:h})=>{let p=new _exceljs2.default.Workbook;i=i.filter(a=>!_optionalChain([a, 'access', _2 => _2.options, 'optionalAccess', _3 => _3.disabledColumn]));let n=p.addWorksheet(h||_optionalChain([r, 'optionalAccess', _4 => _4.titleExcel])),u=i.length,k=n.addRow([]);if(k.getCell(1).value=h||_optionalChain([r, 'optionalAccess', _5 => _5.titleExcel]),k.getCell(1).alignment={horizontal:"center"},n.mergeCells(`A${k.number}:${String.fromCharCode(64+u)}${k.number}`),k.eachCell(a=>{a.font={color:{argb:"000000"},bold:!0,size:12}}),t){let a=n.addRow([]);a.getCell(1).value=`Tanggal : ${_optionalChain([t, 'optionalAccess', _6 => _6.start_date])} ${_optionalChain([t, 'optionalAccess', _7 => _7.end_date])?`s/d ${_optionalChain([t, 'optionalAccess', _8 => _8.end_date])}`:""}`,a.getCell(1).alignment={horizontal:"center"},n.mergeCells(`A${a.number}:${String.fromCharCode(64+u)}${a.number}`),a.eachCell(e=>{e.font={color:{argb:"00000"},bold:!0,size:12}})}let R=n.addRow([]);R.getCell(1).value=_optionalChain([r, 'optionalAccess', _9 => _9.additionalTextHeader])||"",R.getCell(1).alignment={horizontal:"center"},n.mergeCells(`A${R.number}:${String.fromCharCode(64+u)}${R.number}`),R.eachCell(a=>{a.font={color:{argb:"000000"},bold:!0,size:12}}),n.addRow(i).eachCell(a=>{a.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([r, 'optionalAccess', _10 => _10.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([r, 'optionalAccess', _11 => _11.bgColor])||"#E8E5E5"}},a.font={color:{argb:_optionalChain([r, 'optionalAccess', _12 => _12.txtColor])},bold:!0};let e=a.value;a.value&&(a.alignment={horizontal:`${_optionalChain([e, 'optionalAccess', _13 => _13.options, 'optionalAccess', _14 => _14.halign])?_optionalChain([e, 'optionalAccess', _15 => _15.options, 'optionalAccess', _16 => _16.halign]):_optionalChain([e, 'optionalAccess', _17 => _17.options, 'optionalAccess', _18 => _18.format])==="RP"||_optionalChain([e, 'optionalAccess', _19 => _19.options, 'optionalAccess', _20 => _20.format])==="GR"?"right":"left"}`},a.value=e.label)});let E={};m.forEach(a=>{if(c.length>0){let e=c.map(l=>({value:a[l]!==void 0?`${_(l)} : `+a[l]:""}));n.addRow(e.map(l=>l.value));let C={};a.detail.forEach(l=>{let f=i.map(g=>{let d=_optionalChain([g, 'optionalAccess', _21 => _21.options, 'optionalAccess', _22 => _22.format])==="DATETIME"?G(l[g.key]):l[g.key],w={horizontal:_optionalChain([g, 'optionalAccess', _23 => _23.options, 'optionalAccess', _24 => _24.halign])?_optionalChain([g, 'optionalAccess', _25 => _25.options, 'optionalAccess', _26 => _26.halign]):_optionalChain([g, 'optionalAccess', _27 => _27.options, 'optionalAccess', _28 => _28.format])==="RP"||_optionalChain([g, 'optionalAccess', _29 => _29.options, 'optionalAccess', _30 => _30.format])==="GR"?"right":"left"},x=g.key;return E[x]=(E[x]||0)+Number(d),C[x]=(C[x]||0)+Number(d),{value:d,alignment:w,numFmt:_optionalChain([g, 'optionalAccess', _31 => _31.options, 'optionalAccess', _32 => _32.format])==="RP"?"#,##0":_optionalChain([g, 'optionalAccess', _33 => _33.options, 'optionalAccess', _34 => _34.format])==="GR"?"#,##0.000":void 0}}),s=n.addRow(f.map(g=>g.value));f.forEach((g,d)=>{let w=s.getCell(d+1);w.alignment=g.alignment,g.numFmt&&(w.numFmt=g.numFmt)})});let o=n.addRow(i.map(()=>null));i.forEach((l,f)=>{if(_optionalChain([l, 'optionalAccess', _35 => _35.options, 'optionalAccess', _36 => _36.format])==="RP"||_optionalChain([l, 'optionalAccess', _37 => _37.options, 'optionalAccess', _38 => _38.format])==="GR"){let g=m.length+4-1,d=`SUM(${String.fromCharCode(65+f)}4:${String.fromCharCode(65+f)}${g})`,w=o.getCell(f+1);o.getCell(1).value="SUB TOTAL",o.getCell(1).alignment={horizontal:"center"},w.numFmt=_optionalChain([l, 'optionalAccess', _39 => _39.options, 'optionalAccess', _40 => _40.format])==="GR"?"#,##0.000":"#,##0",w.value={formula:d},o.getCell(f+1).value=_optionalChain([l, 'optionalAccess', _41 => _41.options, 'access', _42 => _42.disabledFooter])?"":C[l.key]}else o.getCell(f+1).value=""}),_optionalChain([r, 'optionalAccess', _43 => _43.grandTotalSetting, 'optionalAccess', _44 => _44.colSpan])&&n.mergeCells(`A${o.number}:${String.fromCharCode(64+Number(_optionalChain([r, 'optionalAccess', _45 => _45.grandTotalSetting, 'optionalAccess', _46 => _46.colSpan])))}${o.number}`),o.eachCell(l=>{l.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([r, 'optionalAccess', _47 => _47.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([r, 'optionalAccess', _48 => _48.bgColor])||"#E8E5E5"}},l.font={color:{argb:_optionalChain([r, 'optionalAccess', _49 => _49.txtColor])},bold:!0}})}else{let e=i.map(o=>{let l=_optionalChain([o, 'optionalAccess', _50 => _50.options, 'optionalAccess', _51 => _51.format])==="DATETIME"?G(a[o.key]):a[o.key],f={vertical:"middle",horizontal:_optionalChain([o, 'optionalAccess', _52 => _52.options, 'optionalAccess', _53 => _53.halign])?_optionalChain([o, 'optionalAccess', _54 => _54.options, 'optionalAccess', _55 => _55.halign]):_optionalChain([o, 'optionalAccess', _56 => _56.options, 'optionalAccess', _57 => _57.format])==="RP"||_optionalChain([o, 'optionalAccess', _58 => _58.options, 'optionalAccess', _59 => _59.format])==="GR"?"right":"left"},s=o.key;return E[s]=(E[s]||0)+Number(l),{value:l,options:_optionalChain([o, 'optionalAccess', _60 => _60.options]),alignment:f,numFmt:_optionalChain([o, 'optionalAccess', _61 => _61.options, 'optionalAccess', _62 => _62.format])==="RP"?"#,##0":_optionalChain([o, 'optionalAccess', _63 => _63.options, 'optionalAccess', _64 => _64.format])==="GR"?"#,##0.000":_optionalChain([o, 'optionalAccess', _65 => _65.options, 'optionalAccess', _66 => _66.barcodeOption])!==void 0?"BARCODE":void 0}}),C=n.addRow(e.map(o=>o.value));e.forEach((o,l)=>{let f=C.getCell(l+1),s=_optionalChain([o, 'access', _67 => _67.options, 'optionalAccess', _68 => _68.barcodeOption]);if(s!==void 0){let w=document.createElement("canvas");_browser2.default.toCanvas(w,{bcid:s.format||"code128",text:String(o.value),scale:3,height:10,includetext:s.showText||!0,textxalign:"center"});let x=f.workbook.addImage({base64:w.toDataURL("image/png"),extension:"png"});C.height=s.heightColumn||39;let F=n.getColumn(l+1);return F.width=s.widthColumn||12,n.addImage(x,{tl:{col:l+1-1,row:Number(f.row||0)-1},ext:{width:s.widthBarcode||100,height:s.heightBarcode||50}}),f.alignment={horizontal:"center"},f.value="",null}let g=o.alignment.vertical?String(o.alignment.vertical||"bottom"):"bottom",d="";(g==="middle"||g==="bottom"||g==="justify"||g==="distributed"||g==="top")&&(d=g),f.alignment={horizontal:o.alignment.horizontal,vertical:d},o.numFmt&&(f.numFmt=o.numFmt)})}});let b=n.addRow(i.map(()=>null));i.forEach((a,e)=>{if(_optionalChain([a, 'optionalAccess', _69 => _69.options, 'optionalAccess', _70 => _70.format])==="RP"||_optionalChain([a, 'optionalAccess', _71 => _71.options, 'optionalAccess', _72 => _72.format])==="GR"){let o=m.length+4-1,l=`SUM(${String.fromCharCode(65+e)}4:${String.fromCharCode(65+e)}${o})`,f=b.getCell(e+1);b.getCell(1).value="GRAND TOTAL",b.getCell(1).alignment={horizontal:"center"},f.numFmt=_optionalChain([a, 'optionalAccess', _73 => _73.options, 'optionalAccess', _74 => _74.format])==="GR"?"#,##0.000":"#,##0",f.value={formula:l},b.getCell(e+1).value=_optionalChain([a, 'optionalAccess', _75 => _75.options, 'access', _76 => _76.disabledFooter])?"":E[a.key]}else b.getCell(e+1).value=""}),_optionalChain([r, 'optionalAccess', _77 => _77.grandTotalSetting, 'optionalAccess', _78 => _78.colSpan])&&n.mergeCells(`A${b.number}:${String.fromCharCode(64+Number(_optionalChain([r, 'optionalAccess', _79 => _79.grandTotalSetting, 'optionalAccess', _80 => _80.colSpan])))}${b.number}`),b.eachCell(a=>{a.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([r, 'optionalAccess', _81 => _81.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([r, 'optionalAccess', _82 => _82.bgColor])||"#E8E5E5"}},a.font={color:{argb:_optionalChain([r, 'optionalAccess', _83 => _83.txtColor])},bold:!0}});let $=await p.xlsx.writeBuffer(),y=new Blob([$],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),T=document.createElement("a");T.href=URL.createObjectURL(y),T.download=`${h||_optionalChain([r, 'optionalAccess', _84 => _84.titleExcel])}.xlsx`,document.body.appendChild(T),T.click(),document.body.removeChild(T)},P=A,_=i=>i.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ");var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var j=({columns:i,data:m,grouping:c,pdfSetting:t,date:r,title:h})=>{let p=new (0, _jspdf2.default)(_optionalChain([t, 'optionalAccess', _85 => _85.orientation]),_optionalChain([t, 'optionalAccess', _86 => _86.unit]),[_optionalChain([t, 'optionalAccess', _87 => _87.width])||297,_optionalChain([t, 'optionalAccess', _88 => _88.height])||210]),n=[],u=r?30:20;i=i.filter(e=>!_optionalChain([e, 'access', _89 => _89.options, 'optionalAccess', _90 => _90.disabledColumn])),p.setFontSize(10);let k=p.internal.pageSize.getWidth(),R=p.splitTextToSize(_optionalChain([t, 'optionalAccess', _91 => _91.textHeaderLeft])||"",110);p.text(R,15,18),p.text(`${h||_optionalChain([t, 'optionalAccess', _92 => _92.titlePdf])}`,k-15,18,{align:"right"}),r&&p.text(`Tanggal : ${_optionalChain([r, 'optionalAccess', _93 => _93.start_date])} ${_optionalChain([r, 'optionalAccess', _94 => _94.end_date])?`s/d ${_optionalChain([r, 'optionalAccess', _95 => _95.end_date])}`:""}`,k-15,22,{align:"right"}),p.setProperties({title:h||_optionalChain([t, 'optionalAccess', _96 => _96.titlePdf])});let v=i.map(e=>({content:e.label,key:e.key,options:_optionalChain([e, 'optionalAccess', _97 => _97.options]),styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _98 => _98.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _99 => _99.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:_optionalChain([e, 'optionalAccess', _100 => _100.options, 'optionalAccess', _101 => _101.halign])?_optionalChain([e, 'optionalAccess', _102 => _102.options, 'optionalAccess', _103 => _103.halign]):_optionalChain([e, 'optionalAccess', _104 => _104.options, 'optionalAccess', _105 => _105.format])==="RP"||_optionalChain([e, 'optionalAccess', _106 => _106.options, 'optionalAccess', _107 => _107.format])==="GR"?"right":"left"}}));n.push(v);let E={};m.forEach(e=>{if(c.length>0){let C=c.map(s=>({content:e[s]!==void 0?`${B(s)} : `+e[s]:""}));n.push(C);let o={};e.detail.forEach(s=>{let g=i.map(d=>{let w=s[d.key],x=d.key;return E[x]=(E[x]||0)+Number(w),o[x]=(o[x]||0)+Number(w),{content:(()=>{switch(_optionalChain([d, 'optionalAccess', _108 => _108.options, 'optionalAccess', _109 => _109.format])){case"RP":return s[d.key]!==void 0?Number(s[d.key]||0).toLocaleString("kr-ko"):"";case"GR":return s[d.key]!==void 0?Number(s[d.key]||0).toFixed(3):"";case"DATETIME":return s[d.key]!==void 0?G(s[d.key]||new Date):"";default:return s[d.key]!==void 0?s[d.key].toString():""}})(),styles:{halign:_optionalChain([d, 'optionalAccess', _110 => _110.options, 'optionalAccess', _111 => _111.halign])?_optionalChain([d, 'optionalAccess', _112 => _112.options, 'optionalAccess', _113 => _113.halign]):_optionalChain([d, 'optionalAccess', _114 => _114.options, 'optionalAccess', _115 => _115.format])==="RP"||_optionalChain([d, 'optionalAccess', _116 => _116.options, 'optionalAccess', _117 => _117.format])==="GR"||typeof s[d.key]=="number"?"right":"left"}}});n.push(g)});let l=[];i.forEach(s=>{let g=o[s.key];if(_optionalChain([s, 'optionalAccess', _118 => _118.options, 'optionalAccess', _119 => _119.format])==="RP"||_optionalChain([s, 'optionalAccess', _120 => _120.options, 'optionalAccess', _121 => _121.format])==="GR"){let d={content:_optionalChain([s, 'optionalAccess', _122 => _122.options, 'optionalAccess', _123 => _123.disabledFooter])?"":(()=>{switch(_optionalChain([s, 'optionalAccess', _124 => _124.options, 'optionalAccess', _125 => _125.format])){case"RP":return g.toLocaleString("kr-ko");case"GR":return g.toFixed(3);default:return g.toString()}})(),styles:{halign:_optionalChain([s, 'optionalAccess', _126 => _126.options, 'optionalAccess', _127 => _127.halign])?_optionalChain([s, 'optionalAccess', _128 => _128.options, 'optionalAccess', _129 => _129.halign]):_optionalChain([s, 'optionalAccess', _130 => _130.options, 'optionalAccess', _131 => _131.format])==="RP"||_optionalChain([s, 'optionalAccess', _132 => _132.options, 'optionalAccess', _133 => _133.format])==="GR"?"right":"left",textColor:`#${_optionalChain([t, 'optionalAccess', _134 => _134.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _135 => _135.bgColor])||"E8E5E5"}`,fontStyle:"bold"}};l.push(d)}else l.push({content:"",styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _136 => _136.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _137 => _137.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let f=_optionalChain([t, 'optionalAccess', _138 => _138.grandTotalSetting, 'optionalAccess', _139 => _139.colSpan])?Number(_optionalChain([t, 'optionalAccess', _140 => _140.grandTotalSetting, 'optionalAccess', _141 => _141.colSpan])||0)+1:0;l[0]={content:"SUB TOTAL",colSpan:f,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _142 => _142.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _143 => _143.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([t, 'optionalAccess', _144 => _144.grandTotalSetting, 'optionalAccess', _145 => _145.colSpan])&&l.splice(1,_optionalChain([t, 'optionalAccess', _146 => _146.grandTotalSetting, 'optionalAccess', _147 => _147.colSpan])),n.push(l)}else{let C=i.map(o=>{let l=e[o.key],f=o.key;return E[f]=(E[f]||0)+Number(l),{options:_optionalChain([o, 'optionalAccess', _148 => _148.options]),content:(()=>{switch(_optionalChain([o, 'optionalAccess', _149 => _149.options, 'optionalAccess', _150 => _150.format])){case"RP":return e[o.key]!==void 0?Number(e[o.key]||0).toLocaleString("kr-ko"):"";case"GR":return e[o.key]!==void 0?Number(e[o.key]||0).toFixed(3):"";case"DATETIME":return e[o.key]!==void 0?G(e[o.key]||new Date):"";default:return e[o.key]!==void 0?e[o.key].toString():""}})(),styles:{halign:_optionalChain([o, 'optionalAccess', _151 => _151.options, 'optionalAccess', _152 => _152.halign])?_optionalChain([o, 'optionalAccess', _153 => _153.options, 'optionalAccess', _154 => _154.halign]):_optionalChain([o, 'optionalAccess', _155 => _155.options, 'optionalAccess', _156 => _156.format])==="RP"||_optionalChain([o, 'optionalAccess', _157 => _157.options, 'optionalAccess', _158 => _158.format])==="GR"||typeof e[o.key]=="number"?"right":"left"}}});n.push(C)}});let b=[];i.forEach(e=>{let C=E[e.key];if(_optionalChain([e, 'optionalAccess', _159 => _159.options, 'optionalAccess', _160 => _160.format])==="RP"||_optionalChain([e, 'optionalAccess', _161 => _161.options, 'optionalAccess', _162 => _162.format])==="GR"){let o={options:_optionalChain([e, 'optionalAccess', _163 => _163.options]),content:_optionalChain([e, 'optionalAccess', _164 => _164.options, 'optionalAccess', _165 => _165.disabledFooter])?"":(()=>{switch(_optionalChain([e, 'optionalAccess', _166 => _166.options, 'optionalAccess', _167 => _167.format])){case"RP":return C.toLocaleString("kr-ko");case"GR":return C.toFixed(3);default:return C.toString()}})(),styles:{halign:_optionalChain([e, 'optionalAccess', _168 => _168.options, 'optionalAccess', _169 => _169.halign])?_optionalChain([e, 'optionalAccess', _170 => _170.options, 'optionalAccess', _171 => _171.halign]):_optionalChain([e, 'optionalAccess', _172 => _172.options, 'optionalAccess', _173 => _173.format])==="RP"||_optionalChain([e, 'optionalAccess', _174 => _174.options, 'optionalAccess', _175 => _175.format])==="GR"?"right":"left",textColor:`#${_optionalChain([t, 'optionalAccess', _176 => _176.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _177 => _177.bgColor])||"E8E5E5"}`,fontStyle:"bold"}};b.push(o)}else b.push({content:"",options:_optionalChain([e, 'optionalAccess', _178 => _178.options]),styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _179 => _179.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _180 => _180.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let $=_optionalChain([t, 'optionalAccess', _181 => _181.grandTotalSetting, 'optionalAccess', _182 => _182.colSpan])?Number(_optionalChain([t, 'optionalAccess', _183 => _183.grandTotalSetting, 'optionalAccess', _184 => _184.colSpan])||0)+1:0;_optionalChain([t, 'optionalAccess', _185 => _185.grandTotalSetting, 'optionalAccess', _186 => _186.disableGrandTotal])||(b[0]={content:"GRAND TOTAL",colSpan:$,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _187 => _187.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _188 => _188.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([t, 'optionalAccess', _189 => _189.grandTotalSetting, 'optionalAccess', _190 => _190.colSpan])&&b.splice(1,_optionalChain([t, 'optionalAccess', _191 => _191.grandTotalSetting, 'optionalAccess', _192 => _192.colSpan])),n.push(b)),n.push([{content:`Print Date : ${G(`${new Date}`)}`,colSpan:i.length,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _193 => _193.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _194 => _194.bgColor])||"E8E5E5"}`,fontStyle:"italic"}}]),_jspdfautotable2.default.call(void 0, p,{head:[],body:n,startY:u,theme:_optionalChain([t, 'optionalAccess', _195 => _195.theme])||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:_optionalChain([t, 'optionalAccess', _196 => _196.fontSIze])||8},headStyles:{fontSize:_optionalChain([t, 'optionalAccess', _197 => _197.fontSIze])||8,textColor:`#${_optionalChain([t, 'optionalAccess', _198 => _198.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _199 => _199.bgColor])||"E8E5E5"}`},tableLineColor:[255,255,255]}),n=[],u=p.lastAutoTable.finalY;let y=p.internal.getNumberOfPages(),T=p.internal.pageSize.width,a=p.internal.pageSize.height;p.setFontSize(10);for(let e=1;e<y+1;e++){let C=T/2,o=a-10;p.setPage(e),p.text(`${e} of ${y}`,C,o,{align:"center"})}if(_optionalChain([t, 'optionalAccess', _200 => _200.openNewTab])){let e=p.output("bloburl");window.open(e)}else p.save(`${h||_optionalChain([t, 'optionalAccess', _201 => _201.titlePdf])}.pdf`)},B=i=>i.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),I=j;var U=i=>{let m=[];for(let c=0;c<1;c++){let t=i.data.map(r=>{let h=i.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(h);)h=h.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(p,n,u)=>{let k=u.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(r[n])?r[n]:[r[n]]).reduce((E,b)=>E+k.replace(/\{([a-z0-9_]+)\}/gm,$=>{let y=$.replace(/(\{|\})/g,"");if(y.match(/nama_barang/)){let T=y.match(/nama_barang/),a=y==="nama_barang2"?[20,40]:y==="nama_barang3"?[40,60]:[0,20];return _optionalChain([b, 'access', _202 => _202[T], 'optionalAccess', _203 => _203.slice, 'call', _204 => _204(...a), 'access', _205 => _205.trim, 'call', _206 => _206()])||""}if(y.match(/deskripsi_jual/)){let T=y.match(/deskripsi_jual/),a=y==="deskripsi_jual2"?[20,40]:y==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([b, 'access', _207 => _207[T], 'optionalAccess', _208 => _208.slice, 'call', _209 => _209(...a), 'access', _210 => _210.trim, 'call', _211 => _211()])||""}if(y.match(/deskripsi/)){let T=y.match(/deskripsi/),a=y==="deskripsi2"?[20,40]:y==="deskripsi3"?[40,60]:[0,20];return _optionalChain([b, 'access', _212 => _212[T], 'optionalAccess', _213 => _213.slice, 'call', _214 => _214(...a), 'access', _215 => _215.trim, 'call', _216 => _216()])||""}return b[y]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return h.replace(/\{([a-z0-9_]+)\}/gm,p=>{let n=p.replace(/(\{|\})/g,"");return n==="intenal_external"?c===0?"Pelanggan":"Internal":n.match(/auto_cut/)?`
VA`:r[n]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail_barang\)/g,"").replace(/[}{]/g,"")});for(let r in t)t[r]+=`

`;m.push(...t)}return m},H=async(i,m)=>{let c=U(i),t=new Blob([_optionalChain([c, 'optionalAccess', _217 => _217.join, 'call', _218 => _218(`
`)])||""],{type:"text/plain"}),r=document.createElement("a");r.href=URL.createObjectURL(t),r.download=m,document.body.appendChild(r),r.click(),document.body.removeChild(r)},S=H;var lt=({columns:i,data:m,grouping:c,date:t,type:r,txtSetting:h,pdfSetting:p,excelSetting:n,title:u})=>{let k={data:_optionalChain([h, 'optionalAccess', _219 => _219.dataTxt, 'optionalAccess', _220 => _220.length])?_optionalChain([h, 'optionalAccess', _221 => _221.dataTxt]):[_optionalChain([h, 'optionalAccess', _222 => _222.dataTxt])],template:_optionalChain([h, 'optionalAccess', _223 => _223.templateTxt])};r.forEach(R=>{R==="PDF"?I({pdfSetting:p,date:t,data:m,type:r,columns:i,grouping:c,title:u}):R==="TXT"?S(k,_optionalChain([h, 'optionalAccess', _224 => _224.titleTxt])||""):R==="EXCEL"?P({date:t,data:m,type:r,columns:i,grouping:c,excelSetting:n,title:u}):(P({date:t,data:m,type:r,columns:i,grouping:c,excelSetting:n,title:u}),I({pdfSetting:p,date:t,data:m,type:r,columns:i,grouping:c,title:u}),S(k,_optionalChain([h, 'optionalAccess', _225 => _225.titleTxt])||""))})};exports.ExportData = lt;
//# sourceMappingURL=index.js.map