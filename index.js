"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }function D(s){let g=new Date(s),b=g.getFullYear(),o=String(g.getMonth()+1).padStart(2,"0"),a=String(g.getDate()).padStart(2,"0"),c=String(g.getHours()).padStart(2,"0"),h=String(g.getMinutes()).padStart(2,"0"),l=String(g.getSeconds()).padStart(2,"0");return`${a}-${o}-${b} ${c}:${h}:${l}`}var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var L=async({columns:s,data:g,grouping:b,date:o,excelSetting:a,title:c,footerSetting:h})=>{let l=new _exceljs2.default.Workbook;s=s.filter(n=>!_optionalChain([n, 'access', _2 => _2.options, 'optionalAccess', _3 => _3.disabledColumn]));let i=l.addWorksheet(c||_optionalChain([a, 'optionalAccess', _4 => _4.titleExcel])),$=s.length,E=i.addRow([]);if(E.getCell(1).value=c||_optionalChain([a, 'optionalAccess', _5 => _5.titleExcel]),E.getCell(1).alignment={horizontal:"center"},i.mergeCells(`A${E.number}:${String.fromCharCode(64+$)}${E.number}`),E.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),o){let n=i.addRow([]);n.getCell(1).value=`${o.caption?o.caption:"Tanggal "} : ${_optionalChain([o, 'optionalAccess', _6 => _6.start_date])} ${_optionalChain([o, 'optionalAccess', _7 => _7.end_date])?`s/d ${_optionalChain([o, 'optionalAccess', _8 => _8.end_date])}`:""}`,n.getCell(1).alignment={horizontal:"center"},i.mergeCells(`A${n.number}:${String.fromCharCode(64+$)}${n.number}`),n.eachCell(t=>{t.font={color:{argb:"00000"},bold:!0,size:12}})}let x=i.addRow([]);x.getCell(1).value=_optionalChain([a, 'optionalAccess', _9 => _9.additionalTextHeader])||"",x.getCell(1).alignment={horizontal:"center"},i.mergeCells(`A${x.number}:${String.fromCharCode(64+$)}${x.number}`),x.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),i.addRow(s).eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _10 => _10.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _11 => _11.bgColor])||"#E8E5E5"}},n.font={color:{argb:_optionalChain([a, 'optionalAccess', _12 => _12.txtColor])},bold:!0};let t=n.value;n.value&&(n.alignment={horizontal:`${_optionalChain([t, 'optionalAccess', _13 => _13.options, 'optionalAccess', _14 => _14.halign])?_optionalChain([t, 'optionalAccess', _15 => _15.options, 'optionalAccess', _16 => _16.halign]):_optionalChain([t, 'optionalAccess', _17 => _17.options, 'optionalAccess', _18 => _18.format])==="RP"||_optionalChain([t, 'optionalAccess', _19 => _19.options, 'optionalAccess', _20 => _20.format])==="GR"?"right":"left"}`},n.value=t.label)});let k={};g.forEach(n=>{if(b.length>0){let t=b.map(p=>({value:n[p]!==void 0?`${_(p)} : `+n[p]:""}));i.addRow(t.map(p=>p.value));let y={};n.detail.forEach(p=>{let m=s.map(d=>{let f=_optionalChain([d, 'optionalAccess', _21 => _21.options, 'optionalAccess', _22 => _22.format])==="DATETIME"?D(p[d.key]):p[d.key],w={horizontal:_optionalChain([d, 'optionalAccess', _23 => _23.options, 'optionalAccess', _24 => _24.halign])?_optionalChain([d, 'optionalAccess', _25 => _25.options, 'optionalAccess', _26 => _26.halign]):_optionalChain([d, 'optionalAccess', _27 => _27.options, 'optionalAccess', _28 => _28.format])==="RP"||_optionalChain([d, 'optionalAccess', _29 => _29.options, 'optionalAccess', _30 => _30.format])==="GR"?"right":"left"},G=d.key;return k[G]=(k[G]||0)+Number(f),y[G]=(y[G]||0)+Number(f),{value:f,alignment:w,numFmt:_optionalChain([d, 'optionalAccess', _31 => _31.options, 'optionalAccess', _32 => _32.format])==="RP"?"#,##0":_optionalChain([d, 'optionalAccess', _33 => _33.options, 'optionalAccess', _34 => _34.format])==="GR"?"#,##0.000":void 0}}),r=i.addRow(m.map(d=>d.value));m.forEach((d,f)=>{let w=r.getCell(f+1);w.alignment=d.alignment,d.numFmt&&(w.numFmt=d.numFmt)})});let e=i.addRow(s.map(()=>null));s.forEach((p,m)=>{if(_optionalChain([p, 'optionalAccess', _35 => _35.options, 'optionalAccess', _36 => _36.format])==="RP"||_optionalChain([p, 'optionalAccess', _37 => _37.options, 'optionalAccess', _38 => _38.format])==="GR"){let d=g.length+4-1,f=`SUM(${String.fromCharCode(65+m)}4:${String.fromCharCode(65+m)}${d})`,w=e.getCell(m+1);e.getCell(1).value=`${_optionalChain([h, 'optionalAccess', _39 => _39.subTotal, 'optionalAccess', _40 => _40.caption])||"SUB TOTAL"} ${_optionalChain([h, 'optionalAccess', _41 => _41.subTotal, 'optionalAccess', _42 => _42.enableCount])&&`: ${n.detail.length}`} ${_optionalChain([h, 'optionalAccess', _43 => _43.subTotal, 'optionalAccess', _44 => _44.captionItem])&&h.subTotal.captionItem||""}`,e.getCell(1).alignment={horizontal:"center"},w.numFmt=_optionalChain([p, 'optionalAccess', _45 => _45.options, 'optionalAccess', _46 => _46.format])==="GR"?"#,##0.000":"#,##0",w.value={formula:f},e.getCell(m+1).value=_optionalChain([p, 'optionalAccess', _47 => _47.options, 'access', _48 => _48.disabledFooter])?"":y[p.key]}else e.getCell(m+1).value=""}),_optionalChain([a, 'optionalAccess', _49 => _49.grandTotalSetting, 'optionalAccess', _50 => _50.colSpan])&&i.mergeCells(`A${e.number}:${String.fromCharCode(64+Number(_optionalChain([a, 'optionalAccess', _51 => _51.grandTotalSetting, 'optionalAccess', _52 => _52.colSpan])))}${e.number}`),e.eachCell(p=>{p.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _53 => _53.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _54 => _54.bgColor])||"#E8E5E5"}},p.font={color:{argb:_optionalChain([a, 'optionalAccess', _55 => _55.txtColor])},bold:!0}})}else{let t=s.map(e=>{let p=_optionalChain([e, 'optionalAccess', _56 => _56.options, 'optionalAccess', _57 => _57.format])==="DATETIME"?D(n[e.key]):n[e.key],m={vertical:"middle",horizontal:_optionalChain([e, 'optionalAccess', _58 => _58.options, 'optionalAccess', _59 => _59.halign])?_optionalChain([e, 'optionalAccess', _60 => _60.options, 'optionalAccess', _61 => _61.halign]):_optionalChain([e, 'optionalAccess', _62 => _62.options, 'optionalAccess', _63 => _63.format])==="RP"||_optionalChain([e, 'optionalAccess', _64 => _64.options, 'optionalAccess', _65 => _65.format])==="GR"?"right":"left"},r=e.key;return k[r]=(k[r]||0)+Number(p),{value:p,options:_optionalChain([e, 'optionalAccess', _66 => _66.options]),alignment:m,numFmt:_optionalChain([e, 'optionalAccess', _67 => _67.options, 'optionalAccess', _68 => _68.format])==="RP"?"#,##0":_optionalChain([e, 'optionalAccess', _69 => _69.options, 'optionalAccess', _70 => _70.format])==="GR"?"#,##0.000":void 0}}),y=i.addRow(t.map(e=>e.value));t.forEach((e,p)=>{let m=y.getCell(p+1),r=e.alignment.vertical?String(e.alignment.vertical||"bottom"):"bottom",d="";(r==="middle"||r==="bottom"||r==="justify"||r==="distributed"||r==="top")&&(d=r),m.alignment={horizontal:e.alignment.horizontal,vertical:d},e.numFmt&&(m.numFmt=e.numFmt)})}});let u=i.addRow(s.map(()=>null));s.forEach((n,t)=>{if(_optionalChain([n, 'optionalAccess', _71 => _71.options, 'optionalAccess', _72 => _72.format])==="RP"||_optionalChain([n, 'optionalAccess', _73 => _73.options, 'optionalAccess', _74 => _74.format])==="GR"){let e=g.length+4-1,p=`SUM(${String.fromCharCode(65+t)}4:${String.fromCharCode(65+t)}${e})`,m=u.getCell(t+1);u.getCell(1).value=`${_optionalChain([h, 'optionalAccess', _75 => _75.grandTotal, 'optionalAccess', _76 => _76.caption])||"GRAND TOTAL"} ${_optionalChain([h, 'optionalAccess', _77 => _77.grandTotal, 'optionalAccess', _78 => _78.enableCount])&&` : ${g.map(r=>r.detail.length).reduce((r,d)=>r+d,0)} ${h.grandTotal.captionItem&&h.grandTotal.captionItem||""}`}`,u.getCell(1).alignment={horizontal:"center"},m.numFmt=_optionalChain([n, 'optionalAccess', _79 => _79.options, 'optionalAccess', _80 => _80.format])==="GR"?"#,##0.000":"#,##0",m.value={formula:p},u.getCell(t+1).value=_optionalChain([n, 'optionalAccess', _81 => _81.options, 'access', _82 => _82.disabledFooter])?"":k[n.key]}else u.getCell(t+1).value=""}),_optionalChain([a, 'optionalAccess', _83 => _83.grandTotalSetting, 'optionalAccess', _84 => _84.colSpan])&&i.mergeCells(`A${u.number}:${String.fromCharCode(64+Number(_optionalChain([a, 'optionalAccess', _85 => _85.grandTotalSetting, 'optionalAccess', _86 => _86.colSpan])))}${u.number}`),u.eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _87 => _87.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _88 => _88.bgColor])||"#E8E5E5"}},n.font={color:{argb:_optionalChain([a, 'optionalAccess', _89 => _89.txtColor])},bold:!0}});let C=await l.xlsx.writeBuffer(),R=new Blob([C],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),T=document.createElement("a");T.href=URL.createObjectURL(R),T.download=`${c||_optionalChain([a, 'optionalAccess', _90 => _90.titleExcel])}.xlsx`,document.body.appendChild(T),T.click(),document.body.removeChild(T)},I=L,_=s=>s.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ");var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var O=({columns:s,data:g,grouping:b,pdfSetting:o,date:a,title:c,footerSetting:h})=>{let l=new (0, _jspdf2.default)(_optionalChain([o, 'optionalAccess', _91 => _91.orientation]),_optionalChain([o, 'optionalAccess', _92 => _92.unit]),[_optionalChain([o, 'optionalAccess', _93 => _93.width])||297,_optionalChain([o, 'optionalAccess', _94 => _94.height])||210]),i=[],$=a?30:20;s=s.filter(t=>!_optionalChain([t, 'access', _95 => _95.options, 'optionalAccess', _96 => _96.disabledColumn])),l.setFontSize(10);let E=l.internal.pageSize.getWidth(),x=l.splitTextToSize(_optionalChain([o, 'optionalAccess', _97 => _97.textHeaderLeft])||"",110);l.text(x,15,18),l.text(`${c||_optionalChain([o, 'optionalAccess', _98 => _98.titlePdf])}`,E-15,18,{align:"right"}),a&&l.text(`${a.caption?a.caption:"TANGGAL "} : ${_optionalChain([a, 'optionalAccess', _99 => _99.start_date])} ${_optionalChain([a, 'optionalAccess', _100 => _100.end_date])?`s/d ${_optionalChain([a, 'optionalAccess', _101 => _101.end_date])}`:""}`,E-15,22,{align:"right"}),l.setProperties({title:c||_optionalChain([o, 'optionalAccess', _102 => _102.titlePdf])});let P=s.map(t=>({content:t.label,key:t.key,options:_optionalChain([t, 'optionalAccess', _103 => _103.options]),styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _104 => _104.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _105 => _105.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:_optionalChain([t, 'optionalAccess', _106 => _106.options, 'optionalAccess', _107 => _107.halign])?_optionalChain([t, 'optionalAccess', _108 => _108.options, 'optionalAccess', _109 => _109.halign]):_optionalChain([t, 'optionalAccess', _110 => _110.options, 'optionalAccess', _111 => _111.format])==="RP"||_optionalChain([t, 'optionalAccess', _112 => _112.options, 'optionalAccess', _113 => _113.format])==="GR"?"right":"left"}}));i.push(P);let k={};g.forEach(t=>{if(b.length>0){let y=b.map(r=>({content:t[r]!==void 0?`${U(r)} : `+t[r]:""}));i.push(y);let e={};t.detail.forEach(r=>{let d=s.map(f=>{let w=r[f.key],G=f.key;return k[G]=(k[G]||0)+Number(w),e[G]=(e[G]||0)+Number(w),{content:(()=>{switch(_optionalChain([f, 'optionalAccess', _114 => _114.options, 'optionalAccess', _115 => _115.format])){case"RP":return r[f.key]!==void 0?Number(r[f.key]||0).toLocaleString("kr-ko"):"";case"GR":return r[f.key]!==void 0?Number(r[f.key]||0).toFixed(3):"";case"DATETIME":return r[f.key]!==void 0?D(r[f.key]||new Date):"";default:return r[f.key]!==void 0?r[f.key].toString():""}})(),styles:{halign:_optionalChain([f, 'optionalAccess', _116 => _116.options, 'optionalAccess', _117 => _117.halign])?_optionalChain([f, 'optionalAccess', _118 => _118.options, 'optionalAccess', _119 => _119.halign]):_optionalChain([f, 'optionalAccess', _120 => _120.options, 'optionalAccess', _121 => _121.format])==="RP"||_optionalChain([f, 'optionalAccess', _122 => _122.options, 'optionalAccess', _123 => _123.format])==="GR"||typeof r[f.key]=="number"?"right":"left"}}});i.push(d)});let p=[];s.forEach(r=>{let d=e[r.key];if(_optionalChain([r, 'optionalAccess', _124 => _124.options, 'optionalAccess', _125 => _125.format])==="RP"||_optionalChain([r, 'optionalAccess', _126 => _126.options, 'optionalAccess', _127 => _127.format])==="GR"){let f={content:_optionalChain([r, 'optionalAccess', _128 => _128.options, 'optionalAccess', _129 => _129.disabledFooter])?"":(()=>{switch(_optionalChain([r, 'optionalAccess', _130 => _130.options, 'optionalAccess', _131 => _131.format])){case"RP":return d.toLocaleString("kr-ko");case"GR":return d.toFixed(3);default:return d.toString()}})(),styles:{halign:_optionalChain([r, 'optionalAccess', _132 => _132.options, 'optionalAccess', _133 => _133.halign])?_optionalChain([r, 'optionalAccess', _134 => _134.options, 'optionalAccess', _135 => _135.halign]):_optionalChain([r, 'optionalAccess', _136 => _136.options, 'optionalAccess', _137 => _137.format])==="RP"||_optionalChain([r, 'optionalAccess', _138 => _138.options, 'optionalAccess', _139 => _139.format])==="GR"?"right":"left",textColor:`#${_optionalChain([o, 'optionalAccess', _140 => _140.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _141 => _141.bgColor])||"E8E5E5"}`,fontStyle:"bold"}};p.push(f)}else p.push({content:"",styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _142 => _142.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _143 => _143.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let m=_optionalChain([o, 'optionalAccess', _144 => _144.grandTotalSetting, 'optionalAccess', _145 => _145.colSpan])?Number(_optionalChain([o, 'optionalAccess', _146 => _146.grandTotalSetting, 'optionalAccess', _147 => _147.colSpan])||0)+1:0;p[0]={content:`${_optionalChain([h, 'optionalAccess', _148 => _148.subTotal, 'optionalAccess', _149 => _149.caption])||"SUB TOTAL"} ${_optionalChain([h, 'optionalAccess', _150 => _150.subTotal, 'optionalAccess', _151 => _151.enableCount])&&`: ${t.detail.length}`} ${_optionalChain([h, 'optionalAccess', _152 => _152.subTotal, 'optionalAccess', _153 => _153.captionItem])&&h.subTotal.captionItem||""}`,colSpan:m,styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _154 => _154.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _155 => _155.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([o, 'optionalAccess', _156 => _156.grandTotalSetting, 'optionalAccess', _157 => _157.colSpan])&&p.splice(1,_optionalChain([o, 'optionalAccess', _158 => _158.grandTotalSetting, 'optionalAccess', _159 => _159.colSpan])),i.push(p)}else{let y=s.map(e=>{let p=t[e.key],m=e.key;return k[m]=(k[m]||0)+Number(p),{options:_optionalChain([e, 'optionalAccess', _160 => _160.options]),content:(()=>{switch(_optionalChain([e, 'optionalAccess', _161 => _161.options, 'optionalAccess', _162 => _162.format])){case"RP":return t[e.key]!==void 0?Number(t[e.key]||0).toLocaleString("kr-ko"):"";case"GR":return t[e.key]!==void 0?Number(t[e.key]||0).toFixed(3):"";case"DATETIME":return t[e.key]!==void 0?D(t[e.key]||new Date):"";default:return t[e.key]!==void 0?t[e.key].toString():""}})(),styles:{halign:_optionalChain([e, 'optionalAccess', _163 => _163.options, 'optionalAccess', _164 => _164.halign])?_optionalChain([e, 'optionalAccess', _165 => _165.options, 'optionalAccess', _166 => _166.halign]):_optionalChain([e, 'optionalAccess', _167 => _167.options, 'optionalAccess', _168 => _168.format])==="RP"||_optionalChain([e, 'optionalAccess', _169 => _169.options, 'optionalAccess', _170 => _170.format])==="GR"||typeof t[e.key]=="number"?"right":"left"}}});i.push(y)}});let u=[];s.forEach(t=>{let y=k[t.key];if(_optionalChain([t, 'optionalAccess', _171 => _171.options, 'optionalAccess', _172 => _172.format])==="RP"||_optionalChain([t, 'optionalAccess', _173 => _173.options, 'optionalAccess', _174 => _174.format])==="GR"){let e={options:_optionalChain([t, 'optionalAccess', _175 => _175.options]),content:_optionalChain([t, 'optionalAccess', _176 => _176.options, 'optionalAccess', _177 => _177.disabledFooter])?"":(()=>{switch(_optionalChain([t, 'optionalAccess', _178 => _178.options, 'optionalAccess', _179 => _179.format])){case"RP":return y.toLocaleString("kr-ko");case"GR":return y.toFixed(3);default:return y.toString()}})(),styles:{halign:_optionalChain([t, 'optionalAccess', _180 => _180.options, 'optionalAccess', _181 => _181.halign])?_optionalChain([t, 'optionalAccess', _182 => _182.options, 'optionalAccess', _183 => _183.halign]):_optionalChain([t, 'optionalAccess', _184 => _184.options, 'optionalAccess', _185 => _185.format])==="RP"||_optionalChain([t, 'optionalAccess', _186 => _186.options, 'optionalAccess', _187 => _187.format])==="GR"?"right":"left",textColor:`#${_optionalChain([o, 'optionalAccess', _188 => _188.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _189 => _189.bgColor])||"E8E5E5"}`,fontStyle:"bold"}};u.push(e)}else u.push({content:"",options:_optionalChain([t, 'optionalAccess', _190 => _190.options]),styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _191 => _191.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _192 => _192.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let C=_optionalChain([o, 'optionalAccess', _193 => _193.grandTotalSetting, 'optionalAccess', _194 => _194.colSpan])?Number(_optionalChain([o, 'optionalAccess', _195 => _195.grandTotalSetting, 'optionalAccess', _196 => _196.colSpan])||0)+1:0;_optionalChain([o, 'optionalAccess', _197 => _197.grandTotalSetting, 'optionalAccess', _198 => _198.disableGrandTotal])||(u[0]={content:`${_optionalChain([h, 'optionalAccess', _199 => _199.grandTotal, 'optionalAccess', _200 => _200.caption])||"GRAND TOTAL"} ${_optionalChain([h, 'optionalAccess', _201 => _201.grandTotal, 'optionalAccess', _202 => _202.enableCount])&&` : ${g.map(t=>t.detail.length).reduce((t,y)=>t+y,0)} ${h.grandTotal.captionItem&&h.grandTotal.captionItem||""}`}`,colSpan:C,styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _203 => _203.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _204 => _204.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([o, 'optionalAccess', _205 => _205.grandTotalSetting, 'optionalAccess', _206 => _206.colSpan])&&u.splice(1,_optionalChain([o, 'optionalAccess', _207 => _207.grandTotalSetting, 'optionalAccess', _208 => _208.colSpan])),i.push(u)),i.push([{content:`Print Date : ${D(`${new Date}`)}`,colSpan:s.length,styles:{textColor:`#${_optionalChain([o, 'optionalAccess', _209 => _209.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _210 => _210.bgColor])||"E8E5E5"}`,fontStyle:"italic"}}]),_jspdfautotable2.default.call(void 0, l,{head:[],body:i,startY:$,theme:_optionalChain([o, 'optionalAccess', _211 => _211.theme])||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:_optionalChain([o, 'optionalAccess', _212 => _212.fontSIze])||8},headStyles:{fontSize:_optionalChain([o, 'optionalAccess', _213 => _213.fontSIze])||8,textColor:`#${_optionalChain([o, 'optionalAccess', _214 => _214.txtColor])||"000"}`,fillColor:`#${_optionalChain([o, 'optionalAccess', _215 => _215.bgColor])||"E8E5E5"}`},tableLineColor:[255,255,255]}),i=[],$=l.lastAutoTable.finalY;let R=l.internal.getNumberOfPages(),T=l.internal.pageSize.width,n=l.internal.pageSize.height;l.setFontSize(10);for(let t=1;t<R+1;t++){let y=T/2,e=n-10;l.setPage(t),l.text(`${t} of ${R}`,y,e,{align:"center"})}if(_optionalChain([o, 'optionalAccess', _216 => _216.openNewTab])){let t=l.output("bloburl");window.open(t)}else l.save(`${c||_optionalChain([o, 'optionalAccess', _217 => _217.titlePdf])}.pdf`)},U=s=>s.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "),F=O;var S=s=>{let g=[];for(let b=0;b<1;b++){let o=s.data.map(a=>{let c=s.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(c);)c=c.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(h,l,i)=>{let $=i.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(a[l])?a[l]:[a[l]]).reduce((P,k)=>P+$.replace(/\{([a-z0-9_]+)\}/gm,u=>{let C=u.replace(/(\{|\})/g,"");if(C.match(/nama_barang/)){let R=C.match(/nama_barang/),T=C==="nama_barang2"?[20,40]:C==="nama_barang3"?[40,60]:[0,20];return _optionalChain([k, 'access', _218 => _218[R], 'optionalAccess', _219 => _219.slice, 'call', _220 => _220(...T), 'access', _221 => _221.trim, 'call', _222 => _222()])||""}if(C.match(/deskripsi_jual/)){let R=C.match(/deskripsi_jual/),T=C==="deskripsi_jual2"?[20,40]:C==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([k, 'access', _223 => _223[R], 'optionalAccess', _224 => _224.slice, 'call', _225 => _225(...T), 'access', _226 => _226.trim, 'call', _227 => _227()])||""}if(C.match(/deskripsi/)){let R=C.match(/deskripsi/),T=C==="deskripsi2"?[20,40]:C==="deskripsi3"?[40,60]:[0,20];return _optionalChain([k, 'access', _228 => _228[R], 'optionalAccess', _229 => _229.slice, 'call', _230 => _230(...T), 'access', _231 => _231.trim, 'call', _232 => _232()])||""}return k[C]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return c.replace(/\{([a-z0-9_]+)\}/gm,h=>{let l=h.replace(/(\{|\})/g,"");return l==="intenal_external"?b===0?"Pelanggan":"Internal":l.match(/auto_cut/)?`
VA`:a[l]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail_barang\)/g,"").replace(/[}{]/g,"")});for(let a in o)o[a]+=`

`;g.push(...o)}return g},M=async(s,g)=>{let b=S(s),o=new Blob([_optionalChain([b, 'optionalAccess', _233 => _233.join, 'call', _234 => _234(`
`)])||""],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(o),a.download=g,document.body.appendChild(a),a.click(),document.body.removeChild(a)},z=M;var nt=({columns:s,data:g,grouping:b,date:o,type:a,txtSetting:c,pdfSetting:h,excelSetting:l,title:i})=>{let $={data:_optionalChain([c, 'optionalAccess', _235 => _235.dataTxt, 'optionalAccess', _236 => _236.length])?_optionalChain([c, 'optionalAccess', _237 => _237.dataTxt]):[_optionalChain([c, 'optionalAccess', _238 => _238.dataTxt])],template:_optionalChain([c, 'optionalAccess', _239 => _239.templateTxt])};a.forEach(E=>{E==="PDF"?F({pdfSetting:h,date:o,data:g,type:a,columns:s,grouping:b,title:i}):E==="TXT"?z($,_optionalChain([c, 'optionalAccess', _240 => _240.titleTxt])||""):E==="EXCEL"?I({date:o,data:g,type:a,columns:s,grouping:b,excelSetting:l,title:i}):(I({date:o,data:g,type:a,columns:s,grouping:b,excelSetting:l,title:i}),F({pdfSetting:h,date:o,data:g,type:a,columns:s,grouping:b,title:i}),z($,_optionalChain([c, 'optionalAccess', _241 => _241.titleTxt])||""))})};exports.ExportData = nt;
//# sourceMappingURL=index.js.map