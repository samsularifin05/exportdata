"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var _=["EXCEL","PDF","TXT","ALL"];function D(r){let g=new Date(r),m=g.getFullYear(),t=String(g.getMonth()+1).padStart(2,"0"),a=String(g.getDate()).padStart(2,"0"),b=String(g.getHours()).padStart(2,"0"),d=String(g.getMinutes()).padStart(2,"0"),i=String(g.getSeconds()).padStart(2,"0");return`${a}-${t}-${m} ${b}:${d}:${i}`}function N(r){return r.every(g=>_.includes(g))}var _exceljs = require('exceljs'); var _exceljs2 = _interopRequireDefault(_exceljs);var j=async({columns:r,data:g,grouping:m,date:t,excelSetting:a,title:b,footerSetting:d})=>{let i=new _exceljs2.default.Workbook;r=r.filter(n=>!_optionalChain([n, 'access', _2 => _2.options, 'optionalAccess', _3 => _3.disabledColumn]));let p=i.addWorksheet(b||_optionalChain([a, 'optionalAccess', _4 => _4.titleExcel])),w=r.length,G=p.addRow([]);if(G.getCell(1).value=b||_optionalChain([a, 'optionalAccess', _5 => _5.titleExcel]),G.getCell(1).alignment={horizontal:"center"},p.mergeCells(`A${G.number}:${String.fromCharCode(64+w)}${G.number}`),G.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),t){let n=p.addRow([]);n.getCell(1).value=`${t.caption?t.caption:"Tanggal "} : ${_optionalChain([t, 'optionalAccess', _6 => _6.start_date])} ${_optionalChain([t, 'optionalAccess', _7 => _7.end_date])?`s/d ${_optionalChain([t, 'optionalAccess', _8 => _8.end_date])}`:""}`,n.getCell(1).alignment={horizontal:"center"},p.mergeCells(`A${n.number}:${String.fromCharCode(64+w)}${n.number}`),n.eachCell(e=>{e.font={color:{argb:"00000"},bold:!0,size:12}})}let R=p.addRow([]);R.getCell(1).value=_optionalChain([a, 'optionalAccess', _9 => _9.additionalTextHeader])||"",R.getCell(1).alignment={horizontal:"center"},p.mergeCells(`A${R.number}:${String.fromCharCode(64+w)}${R.number}`),R.eachCell(n=>{n.font={color:{argb:"000000"},bold:!0,size:12}}),p.addRow(r).eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _10 => _10.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _11 => _11.bgColor])||"#E8E5E5"}},n.font={color:{argb:_optionalChain([a, 'optionalAccess', _12 => _12.txtColor])},bold:!0};let e=n.value;n.value&&(n.alignment={horizontal:`${_optionalChain([e, 'optionalAccess', _13 => _13.options, 'optionalAccess', _14 => _14.halign])?_optionalChain([e, 'optionalAccess', _15 => _15.options, 'optionalAccess', _16 => _16.halign]):_optionalChain([e, 'optionalAccess', _17 => _17.options, 'optionalAccess', _18 => _18.format])==="RP"||_optionalChain([e, 'optionalAccess', _19 => _19.options, 'optionalAccess', _20 => _20.format])==="GR"?"right":"left"}`},n.value=e.label)});let T={};g.forEach(n=>{if(m.length>0){let e=m.map(l=>({value:n[l]!==void 0?`${O(l)} : `+n[l]:""}));p.addRow(e.map(l=>l.value));let y={};n.detail.forEach(l=>{let h=r.map(f=>{let s=_optionalChain([f, 'optionalAccess', _21 => _21.options, 'optionalAccess', _22 => _22.format])==="DATETIME"?D(l[f.key]):l[f.key],k={horizontal:_optionalChain([f, 'optionalAccess', _23 => _23.options, 'optionalAccess', _24 => _24.halign])?_optionalChain([f, 'optionalAccess', _25 => _25.options, 'optionalAccess', _26 => _26.halign]):_optionalChain([f, 'optionalAccess', _27 => _27.options, 'optionalAccess', _28 => _28.format])==="RP"||_optionalChain([f, 'optionalAccess', _29 => _29.options, 'optionalAccess', _30 => _30.format])==="GR"?"right":"left"},c=f.key;return T[c]=(T[c]||0)+Number(s),y[c]=(y[c]||0)+Number(s),{value:s,alignment:k,numFmt:_optionalChain([f, 'optionalAccess', _31 => _31.options, 'optionalAccess', _32 => _32.format])==="RP"?"#,##0":_optionalChain([f, 'optionalAccess', _33 => _33.options, 'optionalAccess', _34 => _34.format])==="GR"?"#,##0.000":void 0}}),E=p.addRow(h.map(f=>f.value));h.forEach((f,s)=>{let k=E.getCell(s+1);k.alignment=f.alignment,f.numFmt&&(k.numFmt=f.numFmt)})});let o=p.addRow(r.map(()=>null));r.forEach((l,h)=>{if(_optionalChain([l, 'optionalAccess', _35 => _35.options, 'optionalAccess', _36 => _36.format])==="RP"||_optionalChain([l, 'optionalAccess', _37 => _37.options, 'optionalAccess', _38 => _38.format])==="GR"){let f=g.length+4-1,s=`SUM(${String.fromCharCode(65+h)}4:${String.fromCharCode(65+h)}${f})`,k=o.getCell(h+1),c=_optionalChain([d, 'optionalAccess', _39 => _39.subTotal, 'optionalAccess', _40 => _40.enableCount])&&m.length>0?" : "+n.detail.length:"",F=_optionalChain([d, 'optionalAccess', _41 => _41.subTotal, 'optionalAccess', _42 => _42.captionItem])?_optionalChain([d, 'optionalAccess', _43 => _43.subTotal, 'optionalAccess', _44 => _44.captionItem]):"";o.getCell(1).value=`${_optionalChain([d, 'optionalAccess', _45 => _45.subTotal, 'optionalAccess', _46 => _46.caption])||"SUB TOTAL"} ${c} ${F}`,o.getCell(1).alignment={horizontal:"center"},k.numFmt=_optionalChain([l, 'optionalAccess', _47 => _47.options, 'optionalAccess', _48 => _48.format])==="GR"?"#,##0.000":"#,##0",k.value={formula:s},o.getCell(h+1).value=_optionalChain([l, 'optionalAccess', _49 => _49.options, 'access', _50 => _50.disabledFooter])?"":y[l.key]}else o.getCell(h+1).value=""}),_optionalChain([a, 'optionalAccess', _51 => _51.grandTotalSetting, 'optionalAccess', _52 => _52.colSpan])&&p.mergeCells(`A${o.number}:${String.fromCharCode(64+Number(_optionalChain([a, 'optionalAccess', _53 => _53.grandTotalSetting, 'optionalAccess', _54 => _54.colSpan])))}${o.number}`),o.eachCell(l=>{l.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _55 => _55.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _56 => _56.bgColor])||"#E8E5E5"}},l.font={color:{argb:_optionalChain([a, 'optionalAccess', _57 => _57.txtColor])},bold:!0}})}else{let e=r.map(o=>{let l=_optionalChain([o, 'optionalAccess', _58 => _58.options, 'optionalAccess', _59 => _59.format])==="DATETIME"?D(n[o.key]):n[o.key],h={vertical:"middle",horizontal:_optionalChain([o, 'optionalAccess', _60 => _60.options, 'optionalAccess', _61 => _61.halign])?_optionalChain([o, 'optionalAccess', _62 => _62.options, 'optionalAccess', _63 => _63.halign]):_optionalChain([o, 'optionalAccess', _64 => _64.options, 'optionalAccess', _65 => _65.format])==="RP"||_optionalChain([o, 'optionalAccess', _66 => _66.options, 'optionalAccess', _67 => _67.format])==="GR"?"right":"left"},E=o.key;return T[E]=(T[E]||0)+Number(l),{value:l,options:_optionalChain([o, 'optionalAccess', _68 => _68.options]),alignment:h,numFmt:_optionalChain([o, 'optionalAccess', _69 => _69.options, 'optionalAccess', _70 => _70.format])==="RP"?"#,##0":_optionalChain([o, 'optionalAccess', _71 => _71.options, 'optionalAccess', _72 => _72.format])==="GR"?"#,##0.000":void 0}}),y=p.addRow(e.map(o=>o.value));e.forEach((o,l)=>{let h=y.getCell(l+1),E=o.alignment.vertical?String(o.alignment.vertical||"bottom"):"bottom",f="";(E==="middle"||E==="bottom"||E==="justify"||E==="distributed"||E==="top")&&(f=E),h.alignment={horizontal:o.alignment.horizontal,vertical:f},o.numFmt&&(h.numFmt=o.numFmt)})}});let u=p.addRow(r.map(()=>null));r.forEach((n,e)=>{if(_optionalChain([n, 'optionalAccess', _73 => _73.options, 'optionalAccess', _74 => _74.format])==="RP"||_optionalChain([n, 'optionalAccess', _75 => _75.options, 'optionalAccess', _76 => _76.format])==="GR"){let o=g.length+4-1,l=`SUM(${String.fromCharCode(65+e)}4:${String.fromCharCode(65+e)}${o})`,h=u.getCell(e+1),E=_optionalChain([d, 'optionalAccess', _77 => _77.grandTotal, 'optionalAccess', _78 => _78.enableCount])?m.length>0?" : "+g.map(s=>s.detail.length).reduce((s,k)=>s+k,0):" : "+g.length:"",f=_optionalChain([d, 'optionalAccess', _79 => _79.grandTotal, 'optionalAccess', _80 => _80.captionItem])?_optionalChain([d, 'optionalAccess', _81 => _81.grandTotal, 'optionalAccess', _82 => _82.captionItem]):"";u.getCell(1).value=`
      ${_optionalChain([d, 'optionalAccess', _83 => _83.grandTotal, 'optionalAccess', _84 => _84.caption])||"GRAND TOTAL"} ${E} ${f}`,u.getCell(1).alignment={horizontal:"center"},h.numFmt=_optionalChain([n, 'optionalAccess', _85 => _85.options, 'optionalAccess', _86 => _86.format])==="GR"?"#,##0.000":"#,##0",h.value={formula:l},u.getCell(e+1).value=_optionalChain([n, 'optionalAccess', _87 => _87.options, 'access', _88 => _88.disabledFooter])?"":T[n.key]}else u.getCell(e+1).value=""}),_optionalChain([a, 'optionalAccess', _89 => _89.grandTotalSetting, 'optionalAccess', _90 => _90.colSpan])&&p.mergeCells(`A${u.number}:${String.fromCharCode(64+Number(_optionalChain([a, 'optionalAccess', _91 => _91.grandTotalSetting, 'optionalAccess', _92 => _92.colSpan])))}${u.number}`),u.eachCell(n=>{n.fill={type:"pattern",pattern:"solid",fgColor:{argb:_optionalChain([a, 'optionalAccess', _93 => _93.bgColor])||"#E8E5E5"},bgColor:{argb:_optionalChain([a, 'optionalAccess', _94 => _94.bgColor])||"#E8E5E5"}},n.font={color:{argb:_optionalChain([a, 'optionalAccess', _95 => _95.txtColor])},bold:!0}});let C=await i.xlsx.writeBuffer(),x=new Blob([C],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),$=document.createElement("a");$.href=URL.createObjectURL(x),$.download=`${b||_optionalChain([a, 'optionalAccess', _96 => _96.titleExcel])}.xlsx`,document.body.appendChild($),$.click(),document.body.removeChild($)},L=j,O=r=>r.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ");var _jspdf = require('jspdf'); var _jspdf2 = _interopRequireDefault(_jspdf);var _jspdfautotable = require('jspdf-autotable'); var _jspdfautotable2 = _interopRequireDefault(_jspdfautotable);var X=({columns:r,data:g,grouping:m,pdfSetting:t,date:a,title:b,footerSetting:d})=>{let i=new (0, _jspdf2.default)(_optionalChain([t, 'optionalAccess', _97 => _97.orientation]),_optionalChain([t, 'optionalAccess', _98 => _98.unit]),[_optionalChain([t, 'optionalAccess', _99 => _99.width])||297,_optionalChain([t, 'optionalAccess', _100 => _100.height])||210]),p=[],w=a?30:20;r=r.filter(e=>!_optionalChain([e, 'access', _101 => _101.options, 'optionalAccess', _102 => _102.disabledColumn])),i.setFontSize(10);let G=i.internal.pageSize.getWidth(),R=i.splitTextToSize(_optionalChain([t, 'optionalAccess', _103 => _103.textHeaderLeft])||"",110);i.text(R,15,18),i.text(`${b||_optionalChain([t, 'optionalAccess', _104 => _104.titlePdf])}`,G-15,18,{align:"right"}),a&&i.text(`${a.caption?a.caption:"TANGGAL "} : ${_optionalChain([a, 'optionalAccess', _105 => _105.start_date])} ${_optionalChain([a, 'optionalAccess', _106 => _106.end_date])?`s/d ${_optionalChain([a, 'optionalAccess', _107 => _107.end_date])}`:""}`,G-15,22,{align:"right"}),i.setProperties({title:b||_optionalChain([t, 'optionalAccess', _108 => _108.titlePdf])});let v=r.map(e=>({content:e.label,key:e.key,options:_optionalChain([e, 'optionalAccess', _109 => _109.options]),styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _110 => _110.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _111 => _111.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:_optionalChain([e, 'optionalAccess', _112 => _112.options, 'optionalAccess', _113 => _113.halign])?_optionalChain([e, 'optionalAccess', _114 => _114.options, 'optionalAccess', _115 => _115.halign]):_optionalChain([e, 'optionalAccess', _116 => _116.options, 'optionalAccess', _117 => _117.format])==="RP"||_optionalChain([e, 'optionalAccess', _118 => _118.options, 'optionalAccess', _119 => _119.format])==="GR"?"right":"left"}}));p.push(v);let T={};g.forEach(e=>{if(m.length>0){let y=m.map(s=>({content:e[s]!==void 0?`${M(s)} : `+e[s]:""}));p.push(y);let o={};e.detail.forEach(s=>{let k=r.map(c=>{let F=s[c.key],I=c.key;return T[I]=(T[I]||0)+Number(F),o[I]=(o[I]||0)+Number(F),{content:(()=>{switch(_optionalChain([c, 'optionalAccess', _120 => _120.options, 'optionalAccess', _121 => _121.format])){case"RP":return s[c.key]!==void 0?Number(s[c.key]||0).toLocaleString("kr-ko"):"";case"GR":return s[c.key]!==void 0?Number(s[c.key]||0).toFixed(3):"";case"DATETIME":return s[c.key]!==void 0?D(s[c.key]||new Date):"";default:return s[c.key]!==void 0?s[c.key].toString():""}})(),styles:{halign:_optionalChain([c, 'optionalAccess', _122 => _122.options, 'optionalAccess', _123 => _123.halign])?_optionalChain([c, 'optionalAccess', _124 => _124.options, 'optionalAccess', _125 => _125.halign]):_optionalChain([c, 'optionalAccess', _126 => _126.options, 'optionalAccess', _127 => _127.format])==="RP"||_optionalChain([c, 'optionalAccess', _128 => _128.options, 'optionalAccess', _129 => _129.format])==="GR"||typeof s[c.key]=="number"?"right":"left"}}});p.push(k)});let l=[];r.forEach(s=>{let k=o[s.key];if(_optionalChain([s, 'optionalAccess', _130 => _130.options, 'optionalAccess', _131 => _131.format])==="RP"||_optionalChain([s, 'optionalAccess', _132 => _132.options, 'optionalAccess', _133 => _133.format])==="GR"){let c={content:_optionalChain([s, 'optionalAccess', _134 => _134.options, 'optionalAccess', _135 => _135.disabledFooter])?"":(()=>{switch(_optionalChain([s, 'optionalAccess', _136 => _136.options, 'optionalAccess', _137 => _137.format])){case"RP":return k.toLocaleString("kr-ko");case"GR":return k.toFixed(3);default:return k.toString()}})(),styles:{halign:_optionalChain([s, 'optionalAccess', _138 => _138.options, 'optionalAccess', _139 => _139.halign])?_optionalChain([s, 'optionalAccess', _140 => _140.options, 'optionalAccess', _141 => _141.halign]):_optionalChain([s, 'optionalAccess', _142 => _142.options, 'optionalAccess', _143 => _143.format])==="RP"||_optionalChain([s, 'optionalAccess', _144 => _144.options, 'optionalAccess', _145 => _145.format])==="GR"?"right":"left",textColor:`#${_optionalChain([t, 'optionalAccess', _146 => _146.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _147 => _147.bgColor])||"E8E5E5"}`,fontStyle:"bold"}};l.push(c)}else l.push({content:"",styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _148 => _148.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _149 => _149.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let h=_optionalChain([t, 'optionalAccess', _150 => _150.grandTotalSetting, 'optionalAccess', _151 => _151.colSpan])?Number(_optionalChain([t, 'optionalAccess', _152 => _152.grandTotalSetting, 'optionalAccess', _153 => _153.colSpan])||0)+1:0,E=_optionalChain([d, 'optionalAccess', _154 => _154.subTotal, 'optionalAccess', _155 => _155.enableCount])&&m.length>0?" : "+e.detail.length:"",f=_optionalChain([d, 'optionalAccess', _156 => _156.subTotal, 'optionalAccess', _157 => _157.captionItem])?_optionalChain([d, 'optionalAccess', _158 => _158.subTotal, 'optionalAccess', _159 => _159.captionItem]):"";l[0]={content:`${_optionalChain([d, 'optionalAccess', _160 => _160.subTotal, 'optionalAccess', _161 => _161.caption])||"SUB TOTAL"} ${E} ${f}`,colSpan:h,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _162 => _162.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _163 => _163.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([t, 'optionalAccess', _164 => _164.grandTotalSetting, 'optionalAccess', _165 => _165.colSpan])&&l.splice(1,_optionalChain([t, 'optionalAccess', _166 => _166.grandTotalSetting, 'optionalAccess', _167 => _167.colSpan])),p.push(l)}else{let y=r.map(o=>{let l=e[o.key],h=o.key;return T[h]=(T[h]||0)+Number(l),{options:_optionalChain([o, 'optionalAccess', _168 => _168.options]),content:(()=>{switch(_optionalChain([o, 'optionalAccess', _169 => _169.options, 'optionalAccess', _170 => _170.format])){case"RP":return e[o.key]!==void 0?Number(e[o.key]||0).toLocaleString("kr-ko"):"";case"GR":return e[o.key]!==void 0?Number(e[o.key]||0).toFixed(3):"";case"DATETIME":return e[o.key]!==void 0?D(e[o.key]||new Date):"";default:return e[o.key]!==void 0?e[o.key].toString():""}})(),styles:{halign:_optionalChain([o, 'optionalAccess', _171 => _171.options, 'optionalAccess', _172 => _172.halign])?_optionalChain([o, 'optionalAccess', _173 => _173.options, 'optionalAccess', _174 => _174.halign]):_optionalChain([o, 'optionalAccess', _175 => _175.options, 'optionalAccess', _176 => _176.format])==="RP"||_optionalChain([o, 'optionalAccess', _177 => _177.options, 'optionalAccess', _178 => _178.format])==="GR"||typeof e[o.key]=="number"?"right":"left"}}});p.push(y)}});let u=[];r.forEach(e=>{let y=T[e.key];if(_optionalChain([e, 'optionalAccess', _179 => _179.options, 'optionalAccess', _180 => _180.format])==="RP"||_optionalChain([e, 'optionalAccess', _181 => _181.options, 'optionalAccess', _182 => _182.format])==="GR"){let o={options:_optionalChain([e, 'optionalAccess', _183 => _183.options]),content:_optionalChain([e, 'optionalAccess', _184 => _184.options, 'optionalAccess', _185 => _185.disabledFooter])?"":(()=>{switch(_optionalChain([e, 'optionalAccess', _186 => _186.options, 'optionalAccess', _187 => _187.format])){case"RP":return y.toLocaleString("kr-ko");case"GR":return y.toFixed(3);default:return y.toString()}})(),styles:{halign:_optionalChain([e, 'optionalAccess', _188 => _188.options, 'optionalAccess', _189 => _189.halign])?_optionalChain([e, 'optionalAccess', _190 => _190.options, 'optionalAccess', _191 => _191.halign]):_optionalChain([e, 'optionalAccess', _192 => _192.options, 'optionalAccess', _193 => _193.format])==="RP"||_optionalChain([e, 'optionalAccess', _194 => _194.options, 'optionalAccess', _195 => _195.format])==="GR"?"right":"left",textColor:`#${_optionalChain([t, 'optionalAccess', _196 => _196.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _197 => _197.bgColor])||"E8E5E5"}`,fontStyle:"bold"}};u.push(o)}else u.push({content:"",options:_optionalChain([e, 'optionalAccess', _198 => _198.options]),styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _199 => _199.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _200 => _200.bgColor])||"E8E5E5"}`,fontStyle:"bold"}})});let C=_optionalChain([t, 'optionalAccess', _201 => _201.grandTotalSetting, 'optionalAccess', _202 => _202.colSpan])?Number(_optionalChain([t, 'optionalAccess', _203 => _203.grandTotalSetting, 'optionalAccess', _204 => _204.colSpan])||0)+1:0;if(!_optionalChain([t, 'optionalAccess', _205 => _205.grandTotalSetting, 'optionalAccess', _206 => _206.disableGrandTotal])){let e=_optionalChain([d, 'optionalAccess', _207 => _207.grandTotal, 'optionalAccess', _208 => _208.enableCount])?m.length>0?" : "+g.map(o=>o.detail.length).reduce((o,l)=>o+l,0):" : "+g.length:"",y=_optionalChain([d, 'optionalAccess', _209 => _209.grandTotal, 'optionalAccess', _210 => _210.captionItem])?_optionalChain([d, 'optionalAccess', _211 => _211.grandTotal, 'optionalAccess', _212 => _212.captionItem]):"";u[0]={content:`${_optionalChain([d, 'optionalAccess', _213 => _213.grandTotal, 'optionalAccess', _214 => _214.caption])||"GRAND TOTAL"} ${e} ${y}`,colSpan:C,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _215 => _215.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _216 => _216.bgColor])||"E8E5E5"}`,fontStyle:"bold",halign:"center"}},_optionalChain([t, 'optionalAccess', _217 => _217.grandTotalSetting, 'optionalAccess', _218 => _218.colSpan])&&u.splice(1,_optionalChain([t, 'optionalAccess', _219 => _219.grandTotalSetting, 'optionalAccess', _220 => _220.colSpan])),p.push(u)}p.push([{content:`Print Date : ${D(`${new Date}`)}`,colSpan:r.length,styles:{textColor:`#${_optionalChain([t, 'optionalAccess', _221 => _221.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _222 => _222.bgColor])||"E8E5E5"}`,fontStyle:"italic"}}]),_jspdfautotable2.default.call(void 0, i,{head:[],body:p,startY:w,theme:_optionalChain([t, 'optionalAccess', _223 => _223.theme])||"plain",rowPageBreak:"avoid",margin:{top:10},bodyStyles:{fontSize:_optionalChain([t, 'optionalAccess', _224 => _224.fontSIze])||8},headStyles:{fontSize:_optionalChain([t, 'optionalAccess', _225 => _225.fontSIze])||8,textColor:`#${_optionalChain([t, 'optionalAccess', _226 => _226.txtColor])||"000"}`,fillColor:`#${_optionalChain([t, 'optionalAccess', _227 => _227.bgColor])||"E8E5E5"}`},tableLineColor:[255,255,255]}),p=[],w=i.lastAutoTable.finalY;let x=i.internal.getNumberOfPages(),$=i.internal.pageSize.width,n=i.internal.pageSize.height;i.setFontSize(10);for(let e=1;e<x+1;e++){let y=$/2,o=n-10;i.setPage(e),i.text(`${e} of ${x}`,y,o,{align:"center"})}if(_optionalChain([t, 'optionalAccess', _228 => _228.openNewTab])){let e=i.output("bloburl");window.open(e)}else i.save(`${b||_optionalChain([t, 'optionalAccess', _229 => _229.titlePdf])}.pdf`)},M=r=>r.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),A=X;var B=r=>{let g=[];for(let m=0;m<1;m++){let t=r.data.map(a=>{let b=r.template;for(;/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/gm.exec(b);)b=b.replace(/\n!!LOOP\((.+)\)(\{\n(.*\n)+\})\n/,(d,i,p)=>{let w=p.replace(/^\{/,"").replace(/\}$/,"");return(Array.isArray(a[i])?a[i]:[a[i]]).reduce((v,T)=>v+w.replace(/\{([a-z0-9_]+)\}/gm,u=>{let C=u.replace(/(\{|\})/g,"");if(C.match(/nama_barang/)){let x=C.match(/nama_barang/),$=C==="nama_barang2"?[20,40]:C==="nama_barang3"?[40,60]:[0,20];return _optionalChain([T, 'access', _230 => _230[x], 'optionalAccess', _231 => _231.slice, 'call', _232 => _232(...$), 'access', _233 => _233.trim, 'call', _234 => _234()])||""}if(C.match(/deskripsi_jual/)){let x=C.match(/deskripsi_jual/),$=C==="deskripsi_jual2"?[20,40]:C==="deskripsi_jual3"?[40,60]:[0,20];return _optionalChain([T, 'access', _235 => _235[x], 'optionalAccess', _236 => _236.slice, 'call', _237 => _237(...$), 'access', _238 => _238.trim, 'call', _239 => _239()])||""}if(C.match(/deskripsi/)){let x=C.match(/deskripsi/),$=C==="deskripsi2"?[20,40]:C==="deskripsi3"?[40,60]:[0,20];return _optionalChain([T, 'access', _240 => _240[x], 'optionalAccess', _241 => _241.slice, 'call', _242 => _242(...$), 'access', _243 => _243.trim, 'call', _244 => _244()])||""}return T[C]||""}),"").replace(/\n(\s)+\n/gm,`
`)});return b.replace(/\{([a-z0-9_]+)\}/gm,d=>{let i=d.replace(/(\{|\})/g,"");return i==="intenal_external"?m===0?"Pelanggan":"Internal":i.match(/auto_cut/)?`
VA`:a[i]||""}).replace(/\n(\s)+\n/gm,`
`).replace(/~new_line~/gm,`
`).replace(/!!LOOP\(detail_barang\)/g,"").replace(/[}{]/g,"")});for(let a in t)t[a]+=`

`;g.push(...t)}return g},K=async(r,g)=>{let m=B(r),t=new Blob([_optionalChain([m, 'optionalAccess', _245 => _245.join, 'call', _246 => _246(`
`)])||""],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download=g,document.body.appendChild(a),a.click(),document.body.removeChild(a)},z=K;var mt=({columns:r,data:g,grouping:m,date:t,type:a,txtSetting:b,pdfSetting:d,excelSetting:i,title:p,footerSetting:w})=>{let G={data:_optionalChain([b, 'optionalAccess', _247 => _247.dataTxt, 'optionalAccess', _248 => _248.length])?_optionalChain([b, 'optionalAccess', _249 => _249.dataTxt]):[_optionalChain([b, 'optionalAccess', _250 => _250.dataTxt])],template:_optionalChain([b, 'optionalAccess', _251 => _251.templateTxt])};if(g.length===0)throw new Error("Data is required");if(a.length===0)throw new Error("Type is required");if(!N(a))throw new Error('Type Export must use ["EXCEL", "PDF", "TXT", "ALL"]');a.forEach(R=>{R==="PDF"?A({pdfSetting:d,date:t,data:g,type:a,columns:r,grouping:m,title:p,footerSetting:w}):R==="TXT"?z(G,_optionalChain([b, 'optionalAccess', _252 => _252.titleTxt])||""):R==="EXCEL"?L({date:t,data:g,type:a,columns:r,grouping:m,excelSetting:i,title:p,footerSetting:w}):(L({date:t,data:g,type:a,columns:r,grouping:m,excelSetting:i,title:p}),A({pdfSetting:d,date:t,data:g,type:a,columns:r,grouping:m,title:p}),z(G,_optionalChain([b, 'optionalAccess', _253 => _253.titleTxt])||""))})};exports.ExportData = mt;
//# sourceMappingURL=index.js.map